[0m01:20:33.948175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8fbaf0d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8fb915d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8fbadbcf20>]}


============================== 01:20:33.954616 | d940d69d-25be-4ec5-9728-9973cfb7733c ==============================
[0m01:20:33.954616 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:20:33.955842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None'}
[0m01:20:33.974940 [info ] [MainThread]: dbt version: 1.10.15
[0m01:20:33.975741 [info ] [MainThread]: python version: 3.12.1
[0m01:20:33.976450 [info ] [MainThread]: python path: /usr/local/python/3.12.1/bin/python3
[0m01:20:33.977137 [info ] [MainThread]: os info: Linux-6.8.0-1030-azure-x86_64-with-glibc2.39
[0m01:20:34.732371 [info ] [MainThread]: Using profiles dir at /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare
[0m01:20:34.733073 [info ] [MainThread]: Using profiles.yml file at /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/profiles.yml
[0m01:20:34.733669 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/dbt_project.yml
[0m01:20:34.734374 [info ] [MainThread]: adapter type: postgres
[0m01:20:34.734869 [info ] [MainThread]: adapter version: 1.9.1
[0m01:20:34.859751 [info ] [MainThread]: Configuration:
[0m01:20:34.860448 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:20:34.861010 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:20:34.861531 [info ] [MainThread]: Required dependencies:
[0m01:20:34.862094 [debug] [MainThread]: Executing "git --help"
[0m01:20:34.864875 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:20:34.865545 [debug] [MainThread]: STDERR: "b''"
[0m01:20:34.866035 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:20:34.866633 [info ] [MainThread]: Connection:
[0m01:20:34.867188 [info ] [MainThread]:   host: localhost
[0m01:20:34.867819 [info ] [MainThread]:   port: 5432
[0m01:20:34.868493 [info ] [MainThread]:   user: sfaham_anjaneya
[0m01:20:34.869219 [info ] [MainThread]:   database: healthcare
[0m01:20:34.869975 [info ] [MainThread]:   schema: public
[0m01:20:34.870671 [info ] [MainThread]:   connect_timeout: 10
[0m01:20:34.871283 [info ] [MainThread]:   role: None
[0m01:20:34.871792 [info ] [MainThread]:   search_path: None
[0m01:20:34.872431 [info ] [MainThread]:   keepalives_idle: 0
[0m01:20:34.873151 [info ] [MainThread]:   sslmode: None
[0m01:20:34.873864 [info ] [MainThread]:   sslcert: None
[0m01:20:34.874645 [info ] [MainThread]:   sslkey: None
[0m01:20:34.875372 [info ] [MainThread]:   sslrootcert: None
[0m01:20:34.875888 [info ] [MainThread]:   application_name: dbt
[0m01:20:34.876480 [info ] [MainThread]:   retries: 1
[0m01:20:34.877158 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:20:35.002681 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:20:35.210934 [debug] [MainThread]: Using postgres connection "debug"
[0m01:20:35.211575 [debug] [MainThread]: On debug: select 1 as id
[0m01:20:35.212074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:35.287106 [debug] [MainThread]: SQL status: SELECT 1 in 0.075 seconds
[0m01:20:35.288338 [debug] [MainThread]: On debug: Close
[0m01:20:35.288911 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:20:35.289814 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:20:35.291654 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4108646, "process_in_blocks": "52296", "process_kernel_time": 0.366708, "process_mem_max_rss": "132780", "process_out_blocks": "80", "process_user_time": 3.193462}
[0m01:20:35.292332 [debug] [MainThread]: Command `dbt debug` succeeded at 01:20:35.292214 after 1.41 seconds
[0m01:20:35.292788 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:20:35.293311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8fb8aeac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8fb93f2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8fbadbcf20>]}
[0m01:20:35.293859 [debug] [MainThread]: Flushing usage events
[0m01:20:35.441904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:21:17.602915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92465b2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9246893230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9245d2a570>]}


============================== 01:21:17.607727 | 4cfe133e-6209-4853-8f6e-0252ef1b2330 ==============================
[0m01:21:17.607727 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:21:17.608749 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'target_path': 'None', 'log_path': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/logs', 'profiles_dir': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m01:21:17.872167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92453e2e40>]}
[0m01:21:17.957621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9245379c10>]}
[0m01:21:17.958583 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:21:18.106566 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:21:18.107790 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:21:18.108639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924438a4e0>]}
[0m01:21:19.424647 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m01:21:19.425398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92443abda0>]}
[0m01:21:19.789420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9244342750>]}
[0m01:21:19.885494 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/manifest.json
[0m01:21:19.887306 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/semantic_manifest.json
[0m01:21:19.903566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9242614350>]}
[0m01:21:19.904142 [info ] [MainThread]: Found 15 models, 39 data tests, 7 sources, 459 macros
[0m01:21:19.904711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9242736330>]}
[0m01:21:19.907552 [info ] [MainThread]: 
[0m01:21:19.908205 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:21:19.908713 [info ] [MainThread]: 
[0m01:21:19.909500 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:21:19.915519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_healthcare'
[0m01:21:19.916371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_healthcare'
[0m01:21:19.988890 [debug] [ThreadPool]: Using postgres connection "list_healthcare"
[0m01:21:19.989709 [debug] [ThreadPool]: Using postgres connection "list_healthcare"
[0m01:21:19.991379 [debug] [ThreadPool]: On list_healthcare: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare"} */

    select distinct nspname from pg_namespace
  
[0m01:21:19.990566 [debug] [ThreadPool]: On list_healthcare: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare"} */

    select distinct nspname from pg_namespace
  
[0m01:21:19.992003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:19.993101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:20.013183 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m01:21:20.013886 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m01:21:20.016213 [debug] [ThreadPool]: On list_healthcare: Close
[0m01:21:20.018286 [debug] [ThreadPool]: On list_healthcare: Close
[0m01:21:20.027327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_healthcare, now create_healthcare_public_staging)
[0m01:21:20.029923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_healthcare, now create_healthcare_public_warehouse)
[0m01:21:20.030895 [debug] [ThreadPool]: Creating schema "database: "healthcare"
schema: "public_staging"
"
[0m01:21:20.032514 [debug] [ThreadPool]: Creating schema "database: "healthcare"
schema: "public_warehouse"
"
[0m01:21:20.042833 [debug] [ThreadPool]: Using postgres connection "create_healthcare_public_staging"
[0m01:21:20.046894 [debug] [ThreadPool]: On create_healthcare_public_staging: BEGIN
[0m01:21:20.046189 [debug] [ThreadPool]: Using postgres connection "create_healthcare_public_warehouse"
[0m01:21:20.048439 [debug] [ThreadPool]: On create_healthcare_public_warehouse: BEGIN
[0m01:21:20.047712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:20.049135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:20.071868 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m01:21:20.073534 [debug] [ThreadPool]: Using postgres connection "create_healthcare_public_staging"
[0m01:21:20.074303 [debug] [ThreadPool]: On create_healthcare_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "create_healthcare_public_staging"} */
create schema if not exists "public_staging"
[0m01:21:20.072808 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m01:21:20.075164 [debug] [ThreadPool]: Using postgres connection "create_healthcare_public_warehouse"
[0m01:21:20.076218 [debug] [ThreadPool]: On create_healthcare_public_warehouse: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "create_healthcare_public_warehouse"} */
create schema if not exists "public_warehouse"
[0m01:21:20.078132 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m01:21:20.081126 [debug] [ThreadPool]: On create_healthcare_public_staging: COMMIT
[0m01:21:20.081859 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m01:21:20.084564 [debug] [ThreadPool]: On create_healthcare_public_warehouse: COMMIT
[0m01:21:20.082675 [debug] [ThreadPool]: Using postgres connection "create_healthcare_public_staging"
[0m01:21:20.085358 [debug] [ThreadPool]: Using postgres connection "create_healthcare_public_warehouse"
[0m01:21:20.086071 [debug] [ThreadPool]: On create_healthcare_public_staging: COMMIT
[0m01:21:20.086639 [debug] [ThreadPool]: On create_healthcare_public_warehouse: COMMIT
[0m01:21:20.116989 [debug] [ThreadPool]: SQL status: COMMIT in 0.030 seconds
[0m01:21:20.117721 [debug] [ThreadPool]: On create_healthcare_public_warehouse: Close
[0m01:21:20.118478 [debug] [ThreadPool]: SQL status: COMMIT in 0.031 seconds
[0m01:21:20.119188 [debug] [ThreadPool]: On create_healthcare_public_staging: Close
[0m01:21:20.126177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_healthcare_public_warehouse, now list_healthcare_public_staging)
[0m01:21:20.139600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_healthcare_public_staging, now list_healthcare_public_warehouse)
[0m01:21:20.144359 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public_staging"
[0m01:21:20.149126 [debug] [ThreadPool]: On list_healthcare_public_staging: BEGIN
[0m01:21:20.149794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:20.148298 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public_warehouse"
[0m01:21:20.151112 [debug] [ThreadPool]: On list_healthcare_public_warehouse: BEGIN
[0m01:21:20.151770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:20.164179 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m01:21:20.165501 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public_staging"
[0m01:21:20.166379 [debug] [ThreadPool]: On list_healthcare_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare_public_staging"} */
select
      'healthcare' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'healthcare' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'healthcare' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:21:20.174905 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m01:21:20.175662 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public_warehouse"
[0m01:21:20.180438 [debug] [ThreadPool]: On list_healthcare_public_warehouse: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare_public_warehouse"} */
select
      'healthcare' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_warehouse'
    union all
    select
      'healthcare' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_warehouse'
    union all
    select
      'healthcare' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_warehouse'
  
[0m01:21:20.192985 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m01:21:20.198468 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.029 seconds
[0m01:21:20.200743 [debug] [ThreadPool]: On list_healthcare_public_warehouse: ROLLBACK
[0m01:21:20.203700 [debug] [ThreadPool]: On list_healthcare_public_staging: ROLLBACK
[0m01:21:20.205724 [debug] [ThreadPool]: On list_healthcare_public_warehouse: Close
[0m01:21:20.206738 [debug] [ThreadPool]: On list_healthcare_public_staging: Close
[0m01:21:20.224146 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:20.225274 [debug] [MainThread]: On master: BEGIN
[0m01:21:20.226279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:21:20.235504 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:21:20.236046 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:20.236574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:21:20.241600 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:21:20.242891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92427e2e40>]}
[0m01:21:20.243531 [debug] [MainThread]: On master: ROLLBACK
[0m01:21:20.244222 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:20.244668 [debug] [MainThread]: On master: BEGIN
[0m01:21:20.245572 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:21:20.246057 [debug] [MainThread]: On master: COMMIT
[0m01:21:20.246530 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:20.246986 [debug] [MainThread]: On master: COMMIT
[0m01:21:20.247622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:21:20.248093 [debug] [MainThread]: On master: Close
[0m01:21:20.312411 [debug] [Thread-1 (]: Began running node model.healthcare_dw.dim_date
[0m01:21:20.313786 [info ] [Thread-1 (]: 1 of 15 START sql table model public_warehouse.dim_date ........................ [RUN]
[0m01:21:20.312943 [debug] [Thread-2 (]: Began running node model.healthcare_dw.stg_admissions
[0m01:21:20.314665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_healthcare_public_staging, now model.healthcare_dw.dim_date)
[0m01:21:20.315506 [debug] [Thread-3 (]: Began running node model.healthcare_dw.stg_doctors
[0m01:21:20.316038 [debug] [Thread-4 (]: Began running node model.healthcare_dw.stg_hospitals
[0m01:21:20.316763 [info ] [Thread-2 (]: 2 of 15 START sql view model public_staging.stg_admissions ..................... [RUN]
[0m01:21:20.317717 [debug] [Thread-1 (]: Began compiling node model.healthcare_dw.dim_date
[0m01:21:20.318628 [info ] [Thread-3 (]: 3 of 15 START sql view model public_staging.stg_doctors ........................ [RUN]
[0m01:21:20.332413 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.healthcare_dw.stg_doctors'
[0m01:21:20.320702 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_healthcare_public_warehouse, now model.healthcare_dw.stg_admissions)
[0m01:21:20.319452 [info ] [Thread-4 (]: 4 of 15 START sql view model public_staging.stg_hospitals ...................... [RUN]
[0m01:21:20.333236 [debug] [Thread-3 (]: Began compiling node model.healthcare_dw.stg_doctors
[0m01:21:20.334405 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare_dw.dim_date"
[0m01:21:20.334998 [debug] [Thread-2 (]: Began compiling node model.healthcare_dw.stg_admissions
[0m01:21:20.335649 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.healthcare_dw.stg_hospitals'
[0m01:21:20.339647 [debug] [Thread-3 (]: Writing injected SQL for node "model.healthcare_dw.stg_doctors"
[0m01:21:20.342507 [debug] [Thread-2 (]: Writing injected SQL for node "model.healthcare_dw.stg_admissions"
[0m01:21:20.343145 [debug] [Thread-4 (]: Began compiling node model.healthcare_dw.stg_hospitals
[0m01:21:20.344123 [debug] [Thread-2 (]: Began executing node model.healthcare_dw.stg_admissions
[0m01:21:20.345031 [debug] [Thread-1 (]: Began executing node model.healthcare_dw.dim_date
[0m01:21:20.347581 [debug] [Thread-4 (]: Writing injected SQL for node "model.healthcare_dw.stg_hospitals"
[0m01:21:20.376444 [debug] [Thread-4 (]: Began executing node model.healthcare_dw.stg_hospitals
[0m01:21:20.348095 [debug] [Thread-3 (]: Began executing node model.healthcare_dw.stg_doctors
[0m01:21:20.455217 [debug] [Thread-2 (]: Writing runtime sql for node "model.healthcare_dw.stg_admissions"
[0m01:21:20.456097 [debug] [Thread-4 (]: Writing runtime sql for node "model.healthcare_dw.stg_hospitals"
[0m01:21:20.462883 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare_dw.dim_date"
[0m01:21:20.465264 [debug] [Thread-3 (]: Writing runtime sql for node "model.healthcare_dw.stg_doctors"
[0m01:21:20.466660 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:21:20.467370 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:21:20.467886 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:21:20.468626 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: BEGIN
[0m01:21:20.469252 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: BEGIN
[0m01:21:20.469747 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:21:20.470319 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: BEGIN
[0m01:21:20.470857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:20.471427 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:20.471979 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: BEGIN
[0m01:21:20.473812 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:21:20.472519 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:21:20.486761 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m01:21:20.487557 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:21:20.488399 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_admissions"} */

  create view "healthcare"."public_staging"."stg_admissions__dbt_tmp"
    
    
  as (
    -- Staging model for Admissions table
-- Cleans and standardizes admission data from OLTP source

WITH source AS (
    SELECT * FROM "healthcare"."public"."admissions"
),

staged AS (
    SELECT
        admission_id,
        patient_id,
        doctor_id,
        hospital_id,
        insurance_id,
        condition_id,
        medication_id,
        date_of_admission,
        discharge_date,
        admission_type,
        billing_amount,
        room_number,
        test_results,
        -- Derived: Length of Stay
        (discharge_date - date_of_admission) AS length_of_stay,
        -- Derived: Date keys for dimension lookups
        TO_CHAR(date_of_admission, 'YYYYMMDD')::INTEGER AS admission_date_key,
        TO_CHAR(discharge_date, 'YYYYMMDD')::INTEGER AS discharge_date_key
    FROM source
)

SELECT * FROM staged
  );
[0m01:21:20.490942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:21:20.491881 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:21:20.493290 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_date"} */

  
    

  create  table "healthcare"."public_warehouse"."dim_date__dbt_tmp"
  
  
    as
  
  (
    -- Dimension: Date
-- Role-playing dimension for admission and discharge dates
-- Generates a date dimension from min to max dates in admissions

WITH date_range AS (
    SELECT 
        MIN(date_of_admission) AS min_date,
        MAX(discharge_date) AS max_date
    FROM "healthcare"."public"."admissions"
),

date_series AS (
    SELECT 
        generate_series(
            (SELECT min_date FROM date_range),
            (SELECT max_date FROM date_range),
            '1 day'::interval
        )::date AS full_date
)

SELECT
    -- Surrogate key (YYYYMMDD format)
    TO_CHAR(full_date, 'YYYYMMDD')::INTEGER AS date_key,
    -- Full date
    full_date,
    -- Day attributes
    EXTRACT(DOW FROM full_date)::INTEGER AS day_of_week,
    TO_CHAR(full_date, 'Day') AS day_name,
    EXTRACT(WEEK FROM full_date)::INTEGER AS week_of_year,
    -- Month attributes
    EXTRACT(MONTH FROM full_date)::INTEGER AS month,
    TO_CHAR(full_date, 'Month') AS month_name,
    -- Quarter and Year
    'Q' || EXTRACT(QUARTER FROM full_date)::TEXT AS quarter,
    EXTRACT(YEAR FROM full_date)::INTEGER AS year,
    -- Flags
    CASE WHEN EXTRACT(DOW FROM full_date) IN (0, 6) THEN TRUE ELSE FALSE END AS is_weekend,
    FALSE AS is_holiday,  -- Would need external holiday data
    -- Season
    CASE 
        WHEN EXTRACT(MONTH FROM full_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM full_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM full_date) IN (9, 10, 11) THEN 'Fall'
        ELSE 'Winter'
    END AS season
FROM date_series
ORDER BY full_date
  );
  
[0m01:21:20.495454 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m01:21:20.496259 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:21:20.497083 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_hospitals"} */

  create view "healthcare"."public_staging"."stg_hospitals__dbt_tmp"
    
    
  as (
    -- Staging model for Hospitals table
-- Cleans and standardizes hospital data from OLTP source

WITH source AS (
    SELECT * FROM "healthcare"."public"."hospitals"
),

staged AS (
    SELECT
        hospital_id,
        name AS hospital_name,
        -- Placeholder for enriched fields
        'General' AS hospital_type,
        'Unknown' AS city,
        'Unknown' AS state,
        'Medium' AS bed_capacity
    FROM source
)

SELECT * FROM staged
  );
[0m01:21:20.499083 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m01:21:20.499629 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:21:20.500186 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_doctors"} */

  create view "healthcare"."public_staging"."stg_doctors__dbt_tmp"
    
    
  as (
    -- Staging model for Doctors table
-- Cleans and standardizes doctor data from OLTP source

WITH source AS (
    SELECT * FROM "healthcare"."public"."doctors"
),

staged AS (
    SELECT
        doctor_id,
        name AS doctor_name,
        -- Placeholder for enriched fields (would come from external data)
        'General' AS specialty,
        'Mid-Level' AS experience_level
    FROM source
)

SELECT * FROM staged
  );
[0m01:21:20.573987 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.076 seconds
[0m01:21:20.581288 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.081 seconds
[0m01:21:20.582817 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:21:20.586989 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:21:20.587606 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_hospitals"} */
alter table "healthcare"."public_staging"."stg_hospitals__dbt_tmp" rename to "stg_hospitals"
[0m01:21:20.588204 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_doctors"} */
alter table "healthcare"."public_staging"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m01:21:20.589334 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:20.589907 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:20.627619 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: COMMIT
[0m01:21:20.633067 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: COMMIT
[0m01:21:20.634046 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:21:20.635242 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:21:20.635907 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: COMMIT
[0m01:21:20.636574 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: COMMIT
[0m01:21:20.663082 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.173 seconds
[0m01:21:20.669792 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:21:20.670585 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_admissions"} */
alter table "healthcare"."public_staging"."stg_admissions__dbt_tmp" rename to "stg_admissions"
[0m01:21:20.672598 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:20.675521 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: COMMIT
[0m01:21:20.676266 [debug] [Thread-3 (]: SQL status: COMMIT in 0.039 seconds
[0m01:21:20.677020 [debug] [Thread-4 (]: SQL status: COMMIT in 0.040 seconds
[0m01:21:20.677564 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:21:20.688763 [debug] [Thread-4 (]: Applying DROP to: "healthcare"."public_staging"."stg_hospitals__dbt_backup"
[0m01:21:20.684250 [debug] [Thread-3 (]: Applying DROP to: "healthcare"."public_staging"."stg_doctors__dbt_backup"
[0m01:21:20.685071 [debug] [Thread-1 (]: SQL status: SELECT 1857 in 0.191 seconds
[0m01:21:20.689717 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: COMMIT
[0m01:21:20.695736 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:21:20.696827 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:21:20.703481 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:21:20.705878 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_date"} */
alter table "healthcare"."public_warehouse"."dim_date__dbt_tmp" rename to "dim_date"
[0m01:21:20.705042 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_doctors"} */
drop view if exists "healthcare"."public_staging"."stg_doctors__dbt_backup" cascade
[0m01:21:20.704219 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_hospitals"} */
drop view if exists "healthcare"."public_staging"."stg_hospitals__dbt_backup" cascade
[0m01:21:20.707524 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:21:20.710496 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: Close
[0m01:21:20.711154 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m01:21:20.715365 [debug] [Thread-2 (]: Applying DROP to: "healthcare"."public_staging"."stg_admissions__dbt_backup"
[0m01:21:20.716311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m01:21:20.717938 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.011 seconds
[0m01:21:20.719924 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:21:20.720705 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9241291040>]}
[0m01:21:20.722364 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: COMMIT
[0m01:21:20.723769 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: Close
[0m01:21:20.726607 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92426b2c00>]}
[0m01:21:20.724366 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_admissions"} */
drop view if exists "healthcare"."public_staging"."stg_admissions__dbt_backup" cascade
[0m01:21:20.727591 [info ] [Thread-3 (]: 3 of 15 OK created sql view model public_staging.stg_doctors ................... [[32mCREATE VIEW[0m in 0.39s]
[0m01:21:20.725675 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:21:20.725155 [info ] [Thread-4 (]: 4 of 15 OK created sql view model public_staging.stg_hospitals ................. [[32mCREATE VIEW[0m in 0.38s]
[0m01:21:20.728793 [debug] [Thread-3 (]: Finished running node model.healthcare_dw.stg_doctors
[0m01:21:20.729609 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: COMMIT
[0m01:21:20.730151 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:21:20.730986 [debug] [Thread-4 (]: Finished running node model.healthcare_dw.stg_hospitals
[0m01:21:20.731835 [debug] [Thread-3 (]: Began running node model.healthcare_dw.stg_insurance_providers
[0m01:21:20.734839 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: Close
[0m01:21:20.735371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:21:20.735944 [debug] [Thread-4 (]: Began running node model.healthcare_dw.stg_medical_conditions
[0m01:21:20.736657 [info ] [Thread-3 (]: 5 of 15 START sql view model public_staging.stg_insurance_providers ............ [RUN]
[0m01:21:20.739150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92437da990>]}
[0m01:21:20.743061 [debug] [Thread-1 (]: Applying DROP to: "healthcare"."public_warehouse"."dim_date__dbt_backup"
[0m01:21:20.743903 [info ] [Thread-4 (]: 6 of 15 START sql view model public_staging.stg_medical_conditions ............. [RUN]
[0m01:21:20.744735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_doctors, now model.healthcare_dw.stg_insurance_providers)
[0m01:21:20.755565 [debug] [Thread-3 (]: Began compiling node model.healthcare_dw.stg_insurance_providers
[0m01:21:20.745936 [info ] [Thread-2 (]: 2 of 15 OK created sql view model public_staging.stg_admissions ................ [[32mCREATE VIEW[0m in 0.42s]
[0m01:21:20.751682 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:21:20.754355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_hospitals, now model.healthcare_dw.stg_medical_conditions)
[0m01:21:20.759840 [debug] [Thread-3 (]: Writing injected SQL for node "model.healthcare_dw.stg_insurance_providers"
[0m01:21:20.760635 [debug] [Thread-2 (]: Finished running node model.healthcare_dw.stg_admissions
[0m01:21:20.761237 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_date"} */
drop table if exists "healthcare"."public_warehouse"."dim_date__dbt_backup" cascade
[0m01:21:20.761796 [debug] [Thread-4 (]: Began compiling node model.healthcare_dw.stg_medical_conditions
[0m01:21:20.762604 [debug] [Thread-3 (]: Began executing node model.healthcare_dw.stg_insurance_providers
[0m01:21:20.763457 [debug] [Thread-2 (]: Began running node model.healthcare_dw.stg_medications
[0m01:21:20.768149 [debug] [Thread-4 (]: Writing injected SQL for node "model.healthcare_dw.stg_medical_conditions"
[0m01:21:20.768650 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:21:20.773789 [debug] [Thread-3 (]: Writing runtime sql for node "model.healthcare_dw.stg_insurance_providers"
[0m01:21:20.774473 [info ] [Thread-2 (]: 7 of 15 START sql view model public_staging.stg_medications .................... [RUN]
[0m01:21:20.776205 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: Close
[0m01:21:20.776680 [debug] [Thread-4 (]: Began executing node model.healthcare_dw.stg_medical_conditions
[0m01:21:20.777426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_admissions, now model.healthcare_dw.stg_medications)
[0m01:21:20.785872 [debug] [Thread-2 (]: Began compiling node model.healthcare_dw.stg_medications
[0m01:21:20.778036 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:21:20.778760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924019dd00>]}
[0m01:21:20.785154 [debug] [Thread-4 (]: Writing runtime sql for node "model.healthcare_dw.stg_medical_conditions"
[0m01:21:20.790054 [debug] [Thread-2 (]: Writing injected SQL for node "model.healthcare_dw.stg_medications"
[0m01:21:20.790636 [debug] [Thread-3 (]: On model.healthcare_dw.stg_insurance_providers: BEGIN
[0m01:21:20.791406 [info ] [Thread-1 (]: 1 of 15 OK created sql table model public_warehouse.dim_date ................... [[32mSELECT 1857[0m in 0.46s]
[0m01:21:20.792370 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:21:20.793017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:20.793610 [debug] [Thread-2 (]: Began executing node model.healthcare_dw.stg_medications
[0m01:21:20.794241 [debug] [Thread-1 (]: Finished running node model.healthcare_dw.dim_date
[0m01:21:20.801361 [debug] [Thread-1 (]: Began running node model.healthcare_dw.stg_patients
[0m01:21:20.794779 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medical_conditions: BEGIN
[0m01:21:20.804074 [debug] [Thread-2 (]: Writing runtime sql for node "model.healthcare_dw.stg_medications"
[0m01:21:20.805067 [info ] [Thread-1 (]: 8 of 15 START sql view model public_staging.stg_patients ....................... [RUN]
[0m01:21:20.806058 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:20.806721 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m01:21:20.807489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.dim_date, now model.healthcare_dw.stg_patients)
[0m01:21:20.809705 [debug] [Thread-1 (]: Began compiling node model.healthcare_dw.stg_patients
[0m01:21:20.808870 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:21:20.808170 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:21:20.818647 [debug] [Thread-2 (]: On model.healthcare_dw.stg_medications: BEGIN
[0m01:21:20.816598 [debug] [Thread-3 (]: On model.healthcare_dw.stg_insurance_providers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_insurance_providers"} */

  create view "healthcare"."public_staging"."stg_insurance_providers__dbt_tmp"
    
    
  as (
    -- Staging model for Insurance Providers table
-- Cleans and standardizes insurance data from OLTP source

WITH source AS (
    SELECT * FROM "healthcare"."public"."insuranceproviders"
),

staged AS (
    SELECT
        insurance_id,
        name AS provider_name,
        -- Derived: Provider Type based on common names
        CASE 
            WHEN LOWER(name) LIKE '%medicare%' OR LOWER(name) LIKE '%medicaid%' THEN 'Government'
            WHEN LOWER(name) LIKE '%self%' OR name IS NULL THEN 'Self-Pay'
            ELSE 'Private'
        END AS provider_type,
        'Standard' AS coverage_level
    FROM source
)

SELECT * FROM staged
  );
[0m01:21:20.820250 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare_dw.stg_patients"
[0m01:21:20.820922 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m01:21:20.821408 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:20.822229 [debug] [Thread-1 (]: Began executing node model.healthcare_dw.stg_patients
[0m01:21:20.823167 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:21:20.833319 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medical_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medical_conditions"} */

  create view "healthcare"."public_staging"."stg_medical_conditions__dbt_tmp"
    
    
  as (
    -- Staging model for Medical Conditions table
-- Cleans and standardizes condition data from OLTP source

WITH source AS (
    SELECT * FROM "healthcare"."public"."medicalconditions"
),

staged AS (
    SELECT
        condition_id,
        condition_name,
        -- Derived: Condition Category
        CASE 
            WHEN LOWER(condition_name) IN ('diabetes', 'hypertension', 'arthritis', 'asthma') THEN 'Chronic'
            WHEN LOWER(condition_name) LIKE '%infection%' OR LOWER(condition_name) LIKE '%flu%' THEN 'Infectious'
            ELSE 'Acute'
        END AS condition_category,
        -- Derived: Severity Level
        CASE 
            WHEN LOWER(condition_name) IN ('cancer', 'heart disease') THEN 'Critical'
            WHEN LOWER(condition_name) IN ('diabetes', 'hypertension') THEN 'High'
            WHEN LOWER(condition_name) IN ('asthma', 'arthritis') THEN 'Medium'
            ELSE 'Low'
        END AS severity_level,
        -- Derived: Is Chronic flag
        CASE 
            WHEN LOWER(condition_name) IN ('diabetes', 'hypertension', 'arthritis', 'asthma', 'obesity') THEN TRUE
            ELSE FALSE
        END AS is_chronic
    FROM source
)

SELECT * FROM staged
  );
[0m01:21:20.832420 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m01:21:20.832171 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare_dw.stg_patients"
[0m01:21:20.839530 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:21:20.842113 [debug] [Thread-3 (]: On model.healthcare_dw.stg_insurance_providers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_insurance_providers"} */
alter table "healthcare"."public_staging"."stg_insurance_providers__dbt_tmp" rename to "stg_insurance_providers"
[0m01:21:20.844184 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m01:21:20.843103 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:21:20.848788 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:21:20.849298 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m01:21:20.849764 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m01:21:20.850348 [debug] [Thread-1 (]: On model.healthcare_dw.stg_patients: BEGIN
[0m01:21:20.850892 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medical_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medical_conditions"} */
alter table "healthcare"."public_staging"."stg_medical_conditions__dbt_tmp" rename to "stg_medical_conditions"
[0m01:21:20.851464 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:21:20.853143 [debug] [Thread-3 (]: On model.healthcare_dw.stg_insurance_providers: COMMIT
[0m01:21:20.853697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:20.854463 [debug] [Thread-2 (]: On model.healthcare_dw.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medications"} */

  create view "healthcare"."public_staging"."stg_medications__dbt_tmp"
    
    
  as (
    -- Staging model for Medications table
-- Cleans and standardizes medication data from OLTP source

WITH source AS (
    SELECT * FROM "healthcare"."public"."medications"
),

staged AS (
    SELECT
        medication_id,
        medication_name,
        -- Derived: Drug Class based on common medications
        CASE 
            WHEN LOWER(medication_name) LIKE '%cillin%' OR LOWER(medication_name) LIKE '%mycin%' THEN 'Antibiotic'
            WHEN LOWER(medication_name) LIKE '%pril%' OR LOWER(medication_name) LIKE '%sartan%' THEN 'Cardiovascular'
            WHEN LOWER(medication_name) IN ('aspirin', 'ibuprofen', 'paracetamol') THEN 'Painkiller'
            WHEN LOWER(medication_name) LIKE '%metformin%' OR LOWER(medication_name) LIKE '%insulin%' THEN 'Antidiabetic'
            ELSE 'Other'
        END AS drug_class,
        'Oral' AS administration_type,
        TRUE AS requires_prescription
    FROM source
)

SELECT * FROM staged
  );
[0m01:21:20.855170 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:20.855714 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:21:20.859691 [debug] [Thread-3 (]: On model.healthcare_dw.stg_insurance_providers: COMMIT
[0m01:21:20.858830 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medical_conditions: COMMIT
[0m01:21:20.860509 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:21:20.861507 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:21:20.868087 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medical_conditions: COMMIT
[0m01:21:20.866940 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:21:20.867392 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m01:21:20.869444 [debug] [Thread-2 (]: On model.healthcare_dw.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medications"} */
alter table "healthcare"."public_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m01:21:20.870786 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m01:21:20.874658 [debug] [Thread-3 (]: Applying DROP to: "healthcare"."public_staging"."stg_insurance_providers__dbt_backup"
[0m01:21:20.881036 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m01:21:20.880351 [debug] [Thread-4 (]: Applying DROP to: "healthcare"."public_staging"."stg_medical_conditions__dbt_backup"
[0m01:21:20.888387 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:21:20.889387 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medical_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medical_conditions"} */
drop view if exists "healthcare"."public_staging"."stg_medical_conditions__dbt_backup" cascade
[0m01:21:20.882283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m01:21:20.890354 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:21:20.883922 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:21:20.886447 [debug] [Thread-2 (]: On model.healthcare_dw.stg_medications: COMMIT
[0m01:21:20.894192 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:21:20.895180 [debug] [Thread-2 (]: On model.healthcare_dw.stg_medications: COMMIT
[0m01:21:20.891370 [debug] [Thread-1 (]: On model.healthcare_dw.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_patients"} */

  create view "healthcare"."public_staging"."stg_patients__dbt_tmp"
    
    
  as (
    -- Staging model for Patients table
-- Cleans and standardizes patient data from OLTP source

WITH source AS (
    SELECT * FROM "healthcare"."public"."patients"
),

staged AS (
    SELECT
        patient_id,
        name AS patient_name,
        age,
        gender,
        blood_type,
        -- Derived: Age Group classification
        CASE 
            WHEN age BETWEEN 0 AND 18 THEN 'Pediatric'
            WHEN age BETWEEN 19 AND 40 THEN 'Young Adult'
            WHEN age BETWEEN 41 AND 60 THEN 'Middle Age'
            ELSE 'Senior'
        END AS age_group,
        -- Derived: Blood Type Group (without +/-)
        CASE 
            WHEN blood_type LIKE 'A%' THEN 'A'
            WHEN blood_type LIKE 'B%' THEN 'B'
            WHEN blood_type LIKE 'O%' THEN 'O'
            WHEN blood_type LIKE 'AB%' THEN 'AB'
            ELSE 'Unknown'
        END AS blood_type_group
    FROM source
)

SELECT * FROM staged
  );
[0m01:21:20.892374 [debug] [Thread-3 (]: On model.healthcare_dw.stg_insurance_providers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_insurance_providers"} */
drop view if exists "healthcare"."public_staging"."stg_insurance_providers__dbt_backup" cascade
[0m01:21:20.893430 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:21:20.898198 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medical_conditions: Close
[0m01:21:20.899621 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:21:20.901760 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92401cfe30>]}
[0m01:21:20.900876 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m01:21:20.900405 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m01:21:20.903932 [debug] [Thread-3 (]: On model.healthcare_dw.stg_insurance_providers: Close
[0m01:21:20.904750 [info ] [Thread-4 (]: 6 of 15 OK created sql view model public_staging.stg_medical_conditions ........ [[32mCREATE VIEW[0m in 0.15s]
[0m01:21:20.918754 [debug] [Thread-2 (]: Applying DROP to: "healthcare"."public_staging"."stg_medications__dbt_backup"
[0m01:21:20.918068 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92401b0620>]}
[0m01:21:20.907806 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:21:20.919968 [debug] [Thread-4 (]: Finished running node model.healthcare_dw.stg_medical_conditions
[0m01:21:20.921491 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:21:20.922295 [info ] [Thread-3 (]: 5 of 15 OK created sql view model public_staging.stg_insurance_providers ....... [[32mCREATE VIEW[0m in 0.17s]
[0m01:21:20.923021 [debug] [Thread-1 (]: On model.healthcare_dw.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_patients"} */
alter table "healthcare"."public_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m01:21:20.923640 [debug] [Thread-4 (]: Began running node model.healthcare_dw.dim_doctor
[0m01:21:20.924391 [debug] [Thread-2 (]: On model.healthcare_dw.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medications"} */
drop view if exists "healthcare"."public_staging"."stg_medications__dbt_backup" cascade
[0m01:21:20.925152 [debug] [Thread-3 (]: Finished running node model.healthcare_dw.stg_insurance_providers
[0m01:21:20.926124 [info ] [Thread-4 (]: 9 of 15 START sql table model public_warehouse.dim_doctor ...................... [RUN]
[0m01:21:20.926747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:20.927512 [debug] [Thread-3 (]: Began running node model.healthcare_dw.dim_hospital
[0m01:21:20.928386 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:21:20.928923 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_medical_conditions, now model.healthcare_dw.dim_doctor)
[0m01:21:20.931628 [debug] [Thread-1 (]: On model.healthcare_dw.stg_patients: COMMIT
[0m01:21:20.933595 [debug] [Thread-2 (]: On model.healthcare_dw.stg_medications: Close
[0m01:21:20.932282 [info ] [Thread-3 (]: 10 of 15 START sql table model public_warehouse.dim_hospital ................... [RUN]
[0m01:21:20.936386 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_insurance_providers, now model.healthcare_dw.dim_hospital)
[0m01:21:20.934866 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:21:20.935648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924012d040>]}
[0m01:21:20.934322 [debug] [Thread-4 (]: Began compiling node model.healthcare_dw.dim_doctor
[0m01:21:20.937125 [debug] [Thread-3 (]: Began compiling node model.healthcare_dw.dim_hospital
[0m01:21:20.937866 [debug] [Thread-1 (]: On model.healthcare_dw.stg_patients: COMMIT
[0m01:21:20.938855 [info ] [Thread-2 (]: 7 of 15 OK created sql view model public_staging.stg_medications ............... [[32mCREATE VIEW[0m in 0.16s]
[0m01:21:20.942621 [debug] [Thread-4 (]: Writing injected SQL for node "model.healthcare_dw.dim_doctor"
[0m01:21:20.946409 [debug] [Thread-3 (]: Writing injected SQL for node "model.healthcare_dw.dim_hospital"
[0m01:21:20.949323 [debug] [Thread-3 (]: Began executing node model.healthcare_dw.dim_hospital
[0m01:21:20.947850 [debug] [Thread-2 (]: Finished running node model.healthcare_dw.stg_medications
[0m01:21:20.953889 [debug] [Thread-3 (]: Writing runtime sql for node "model.healthcare_dw.dim_hospital"
[0m01:21:20.954526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m01:21:20.955059 [debug] [Thread-2 (]: Began running node model.healthcare_dw.dim_condition
[0m01:21:20.955726 [debug] [Thread-4 (]: Began executing node model.healthcare_dw.dim_doctor
[0m01:21:20.956502 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:21:20.959002 [debug] [Thread-1 (]: Applying DROP to: "healthcare"."public_staging"."stg_patients__dbt_backup"
[0m01:21:20.967760 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:21:20.965695 [debug] [Thread-4 (]: Writing runtime sql for node "model.healthcare_dw.dim_doctor"
[0m01:21:20.966200 [debug] [Thread-3 (]: On model.healthcare_dw.dim_hospital: BEGIN
[0m01:21:20.959672 [info ] [Thread-2 (]: 11 of 15 START sql table model public_warehouse.dim_condition .................. [RUN]
[0m01:21:20.968584 [debug] [Thread-1 (]: On model.healthcare_dw.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_patients"} */
drop view if exists "healthcare"."public_staging"."stg_patients__dbt_backup" cascade
[0m01:21:20.969604 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:21:20.970441 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:20.971278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_medications, now model.healthcare_dw.dim_condition)
[0m01:21:20.972014 [debug] [Thread-4 (]: On model.healthcare_dw.dim_doctor: BEGIN
[0m01:21:20.972904 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:21:20.974236 [debug] [Thread-2 (]: Began compiling node model.healthcare_dw.dim_condition
[0m01:21:20.975270 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:20.978459 [debug] [Thread-1 (]: On model.healthcare_dw.stg_patients: Close
[0m01:21:20.984977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924128ab10>]}
[0m01:21:20.985995 [info ] [Thread-1 (]: 8 of 15 OK created sql view model public_staging.stg_patients .................. [[32mCREATE VIEW[0m in 0.18s]
[0m01:21:20.983153 [debug] [Thread-2 (]: Writing injected SQL for node "model.healthcare_dw.dim_condition"
[0m01:21:20.989584 [debug] [Thread-2 (]: Began executing node model.healthcare_dw.dim_condition
[0m01:21:20.988121 [debug] [Thread-1 (]: Finished running node model.healthcare_dw.stg_patients
[0m01:21:20.999597 [debug] [Thread-2 (]: Writing runtime sql for node "model.healthcare_dw.dim_condition"
[0m01:21:21.000165 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m01:21:21.000801 [debug] [Thread-1 (]: Began running node model.healthcare_dw.dim_insurance
[0m01:21:21.001795 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m01:21:21.002461 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:21:21.003113 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:21:21.003697 [info ] [Thread-1 (]: 12 of 15 START sql table model public_warehouse.dim_insurance .................. [RUN]
[0m01:21:21.004372 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:21:21.004941 [debug] [Thread-3 (]: On model.healthcare_dw.dim_hospital: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_hospital"} */

  
    

  create  table "healthcare"."public_warehouse"."dim_hospital__dbt_tmp"
  
  
    as
  
  (
    -- Dimension: Hospital
-- Contains hospital information with derived attributes

WITH staged_hospitals AS (
    SELECT * FROM "healthcare"."public_staging"."stg_hospitals"
)

SELECT
    -- Surrogate key
    ROW_NUMBER() OVER (ORDER BY hospital_id) AS hospital_key,
    -- Natural key
    hospital_id,
    -- Attributes
    hospital_name,
    hospital_type,
    city,
    state,
    bed_capacity
FROM staged_hospitals
  );
  
[0m01:21:21.005545 [debug] [Thread-2 (]: On model.healthcare_dw.dim_condition: BEGIN
[0m01:21:21.007493 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:21.006107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_patients, now model.healthcare_dw.dim_insurance)
[0m01:21:21.006676 [debug] [Thread-4 (]: On model.healthcare_dw.dim_doctor: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_doctor"} */

  
    

  create  table "healthcare"."public_warehouse"."dim_doctor__dbt_tmp"
  
  
    as
  
  (
    -- Dimension: Doctor
-- Contains doctor information with derived attributes

WITH staged_doctors AS (
    SELECT * FROM "healthcare"."public_staging"."stg_doctors"
)

SELECT
    -- Surrogate key
    ROW_NUMBER() OVER (ORDER BY doctor_id) AS doctor_key,
    -- Natural key
    doctor_id,
    -- Attributes
    doctor_name,
    specialty,
    experience_level
FROM staged_doctors
  );
  
[0m01:21:21.008737 [debug] [Thread-1 (]: Began compiling node model.healthcare_dw.dim_insurance
[0m01:21:21.017850 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare_dw.dim_insurance"
[0m01:21:21.018838 [debug] [Thread-1 (]: Began executing node model.healthcare_dw.dim_insurance
[0m01:21:21.034248 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare_dw.dim_insurance"
[0m01:21:21.035391 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:21:21.036231 [debug] [Thread-1 (]: On model.healthcare_dw.dim_insurance: BEGIN
[0m01:21:21.036937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:21.037857 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m01:21:21.039158 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:21:21.039924 [debug] [Thread-2 (]: On model.healthcare_dw.dim_condition: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_condition"} */

  
    

  create  table "healthcare"."public_warehouse"."dim_condition__dbt_tmp"
  
  
    as
  
  (
    -- Dimension: Medical Condition
-- Contains medical condition information with derived attributes

WITH staged_conditions AS (
    SELECT * FROM "healthcare"."public_staging"."stg_medical_conditions"
)

SELECT
    -- Surrogate key
    ROW_NUMBER() OVER (ORDER BY condition_id) AS condition_key,
    -- Natural key
    condition_id,
    -- Attributes
    condition_name,
    condition_category,
    severity_level,
    is_chronic
FROM staged_conditions
  );
  
[0m01:21:21.052304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m01:21:21.053090 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:21:21.053841 [debug] [Thread-1 (]: On model.healthcare_dw.dim_insurance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_insurance"} */

  
    

  create  table "healthcare"."public_warehouse"."dim_insurance__dbt_tmp"
  
  
    as
  
  (
    -- Dimension: Insurance
-- Contains insurance provider information with derived attributes

WITH staged_insurance AS (
    SELECT * FROM "healthcare"."public_staging"."stg_insurance_providers"
)

SELECT
    -- Surrogate key
    ROW_NUMBER() OVER (ORDER BY insurance_id) AS insurance_key,
    -- Natural key
    insurance_id,
    -- Attributes
    provider_name,
    provider_type,
    coverage_level
FROM staged_insurance
  );
  
[0m01:21:21.056469 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.016 seconds
[0m01:21:21.063483 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:21:21.064342 [debug] [Thread-2 (]: On model.healthcare_dw.dim_condition: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_condition"} */
alter table "healthcare"."public_warehouse"."dim_condition__dbt_tmp" rename to "dim_condition"
[0m01:21:21.066178 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:21.069455 [debug] [Thread-2 (]: On model.healthcare_dw.dim_condition: COMMIT
[0m01:21:21.070336 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.016 seconds
[0m01:21:21.071139 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:21:21.078379 [debug] [Thread-2 (]: On model.healthcare_dw.dim_condition: COMMIT
[0m01:21:21.079581 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:21:21.081078 [debug] [Thread-1 (]: On model.healthcare_dw.dim_insurance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_insurance"} */
alter table "healthcare"."public_warehouse"."dim_insurance__dbt_tmp" rename to "dim_insurance"
[0m01:21:21.083036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:21.087643 [debug] [Thread-1 (]: On model.healthcare_dw.dim_insurance: COMMIT
[0m01:21:21.088633 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:21:21.089817 [debug] [Thread-1 (]: On model.healthcare_dw.dim_insurance: COMMIT
[0m01:21:21.094587 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m01:21:21.100221 [debug] [Thread-2 (]: Applying DROP to: "healthcare"."public_warehouse"."dim_condition__dbt_backup"
[0m01:21:21.102892 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:21:21.104398 [debug] [Thread-2 (]: On model.healthcare_dw.dim_condition: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_condition"} */
drop table if exists "healthcare"."public_warehouse"."dim_condition__dbt_backup" cascade
[0m01:21:21.109420 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:21:21.112119 [debug] [Thread-2 (]: On model.healthcare_dw.dim_condition: Close
[0m01:21:21.113965 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922a747500>]}
[0m01:21:21.115866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m01:21:21.119890 [debug] [Thread-1 (]: Applying DROP to: "healthcare"."public_warehouse"."dim_insurance__dbt_backup"
[0m01:21:21.115333 [info ] [Thread-2 (]: 11 of 15 OK created sql table model public_warehouse.dim_condition ............. [[32mSELECT 6[0m in 0.14s]
[0m01:21:21.122946 [debug] [Thread-2 (]: Finished running node model.healthcare_dw.dim_condition
[0m01:21:21.123797 [debug] [Thread-2 (]: Began running node model.healthcare_dw.dim_medication
[0m01:21:21.121925 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:21:21.125305 [info ] [Thread-2 (]: 13 of 15 START sql table model public_warehouse.dim_medication ................. [RUN]
[0m01:21:21.127485 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.dim_condition, now model.healthcare_dw.dim_medication)
[0m01:21:21.128303 [debug] [Thread-2 (]: Began compiling node model.healthcare_dw.dim_medication
[0m01:21:21.126600 [debug] [Thread-1 (]: On model.healthcare_dw.dim_insurance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_insurance"} */
drop table if exists "healthcare"."public_warehouse"."dim_insurance__dbt_backup" cascade
[0m01:21:21.135543 [debug] [Thread-2 (]: Writing injected SQL for node "model.healthcare_dw.dim_medication"
[0m01:21:21.137383 [debug] [Thread-2 (]: Began executing node model.healthcare_dw.dim_medication
[0m01:21:21.136309 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:21:21.145458 [debug] [Thread-1 (]: On model.healthcare_dw.dim_insurance: Close
[0m01:21:21.148763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922a74a630>]}
[0m01:21:21.147721 [debug] [Thread-2 (]: Writing runtime sql for node "model.healthcare_dw.dim_medication"
[0m01:21:21.151007 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:21:21.151702 [debug] [Thread-2 (]: On model.healthcare_dw.dim_medication: BEGIN
[0m01:21:21.152450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:21.149886 [info ] [Thread-1 (]: 12 of 15 OK created sql table model public_warehouse.dim_insurance ............. [[32mSELECT 5[0m in 0.14s]
[0m01:21:21.154203 [debug] [Thread-1 (]: Finished running node model.healthcare_dw.dim_insurance
[0m01:21:21.156242 [debug] [Thread-1 (]: Began running node model.healthcare_dw.dim_patient
[0m01:21:21.157670 [info ] [Thread-1 (]: 14 of 15 START sql table model public_warehouse.dim_patient .................... [RUN]
[0m01:21:21.159547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.dim_insurance, now model.healthcare_dw.dim_patient)
[0m01:21:21.161252 [debug] [Thread-1 (]: Began compiling node model.healthcare_dw.dim_patient
[0m01:21:21.170781 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare_dw.dim_patient"
[0m01:21:21.171742 [debug] [Thread-1 (]: Began executing node model.healthcare_dw.dim_patient
[0m01:21:21.180893 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare_dw.dim_patient"
[0m01:21:21.182561 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:21:21.184396 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: BEGIN
[0m01:21:21.183494 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m01:21:21.186078 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:21:21.186877 [debug] [Thread-2 (]: On model.healthcare_dw.dim_medication: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_medication"} */

  
    

  create  table "healthcare"."public_warehouse"."dim_medication__dbt_tmp"
  
  
    as
  
  (
    -- Dimension: Medication
-- Contains medication information with derived attributes

WITH staged_medications AS (
    SELECT * FROM "healthcare"."public_staging"."stg_medications"
)

SELECT
    -- Surrogate key
    ROW_NUMBER() OVER (ORDER BY medication_id) AS medication_key,
    -- Natural key
    medication_id,
    -- Attributes
    medication_name,
    drug_class,
    administration_type,
    requires_prescription
FROM staged_medications
  );
  
[0m01:21:21.185264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:21.200034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m01:21:21.200873 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:21:21.201875 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_patient"} */

  
    

  create  table "healthcare"."public_warehouse"."dim_patient__dbt_tmp"
  
  
    as
  
  (
    -- Dimension: Patient
-- Contains patient demographics with derived attributes

WITH staged_patients AS (
    SELECT * FROM "healthcare"."public_staging"."stg_patients"
)

SELECT
    -- Surrogate key
    ROW_NUMBER() OVER (ORDER BY patient_id) AS patient_key,
    -- Natural key
    patient_id,
    -- Attributes
    patient_name,
    age,
    age_group,
    gender,
    blood_type,
    blood_type_group
FROM staged_patients
  );
  
[0m01:21:21.209159 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.021 seconds
[0m01:21:21.215285 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:21:21.216275 [debug] [Thread-2 (]: On model.healthcare_dw.dim_medication: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_medication"} */
alter table "healthcare"."public_warehouse"."dim_medication__dbt_tmp" rename to "dim_medication"
[0m01:21:21.217981 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:21:21.223353 [debug] [Thread-2 (]: On model.healthcare_dw.dim_medication: COMMIT
[0m01:21:21.224366 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:21:21.225377 [debug] [Thread-2 (]: On model.healthcare_dw.dim_medication: COMMIT
[0m01:21:21.308588 [debug] [Thread-2 (]: SQL status: COMMIT in 0.082 seconds
[0m01:21:21.312905 [debug] [Thread-2 (]: Applying DROP to: "healthcare"."public_warehouse"."dim_medication__dbt_backup"
[0m01:21:21.314859 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:21:21.315640 [debug] [Thread-2 (]: On model.healthcare_dw.dim_medication: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_medication"} */
drop table if exists "healthcare"."public_warehouse"."dim_medication__dbt_backup" cascade
[0m01:21:21.316899 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:21:21.320364 [debug] [Thread-2 (]: On model.healthcare_dw.dim_medication: Close
[0m01:21:21.321426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922a708e60>]}
[0m01:21:21.324740 [info ] [Thread-2 (]: 13 of 15 OK created sql table model public_warehouse.dim_medication ............ [[32mSELECT 5[0m in 0.19s]
[0m01:21:21.325908 [debug] [Thread-2 (]: Finished running node model.healthcare_dw.dim_medication
[0m01:21:21.338895 [debug] [Thread-4 (]: SQL status: SELECT 40341 in 0.329 seconds
[0m01:21:21.351742 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:21:21.352518 [debug] [Thread-4 (]: On model.healthcare_dw.dim_doctor: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_doctor"} */
alter table "healthcare"."public_warehouse"."dim_doctor__dbt_tmp" rename to "dim_doctor"
[0m01:21:21.353497 [debug] [Thread-3 (]: SQL status: SELECT 39876 in 0.346 seconds
[0m01:21:21.359262 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:21:21.360844 [debug] [Thread-3 (]: On model.healthcare_dw.dim_hospital: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_hospital"} */
alter table "healthcare"."public_warehouse"."dim_hospital__dbt_tmp" rename to "dim_hospital"
[0m01:21:21.360148 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m01:21:21.364168 [debug] [Thread-4 (]: On model.healthcare_dw.dim_doctor: COMMIT
[0m01:21:21.365693 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:21:21.364868 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:21:21.366506 [debug] [Thread-4 (]: On model.healthcare_dw.dim_doctor: COMMIT
[0m01:21:21.369176 [debug] [Thread-3 (]: On model.healthcare_dw.dim_hospital: COMMIT
[0m01:21:21.370261 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:21:21.371072 [debug] [Thread-3 (]: On model.healthcare_dw.dim_hospital: COMMIT
[0m01:21:21.413218 [debug] [Thread-4 (]: SQL status: COMMIT in 0.043 seconds
[0m01:21:21.423235 [debug] [Thread-4 (]: Applying DROP to: "healthcare"."public_warehouse"."dim_doctor__dbt_backup"
[0m01:21:21.427252 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:21:21.430400 [debug] [Thread-4 (]: On model.healthcare_dw.dim_doctor: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_doctor"} */
drop table if exists "healthcare"."public_warehouse"."dim_doctor__dbt_backup" cascade
[0m01:21:21.433606 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:21:21.437920 [debug] [Thread-4 (]: On model.healthcare_dw.dim_doctor: Close
[0m01:21:21.444555 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922a71fa40>]}
[0m01:21:21.450623 [info ] [Thread-4 (]: 9 of 15 OK created sql table model public_warehouse.dim_doctor ................. [[32mSELECT 40341[0m in 0.52s]
[0m01:21:21.456325 [debug] [Thread-4 (]: Finished running node model.healthcare_dw.dim_doctor
[0m01:21:21.484173 [debug] [Thread-3 (]: SQL status: COMMIT in 0.112 seconds
[0m01:21:21.496761 [debug] [Thread-3 (]: Applying DROP to: "healthcare"."public_warehouse"."dim_hospital__dbt_backup"
[0m01:21:21.499665 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:21:21.500527 [debug] [Thread-3 (]: On model.healthcare_dw.dim_hospital: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_hospital"} */
drop table if exists "healthcare"."public_warehouse"."dim_hospital__dbt_backup" cascade
[0m01:21:21.502169 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:21:21.504784 [debug] [Thread-3 (]: On model.healthcare_dw.dim_hospital: Close
[0m01:21:21.505861 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92401e8080>]}
[0m01:21:21.507092 [info ] [Thread-3 (]: 10 of 15 OK created sql table model public_warehouse.dim_hospital .............. [[32mSELECT 39876[0m in 0.57s]
[0m01:21:21.508392 [debug] [Thread-3 (]: Finished running node model.healthcare_dw.dim_hospital
[0m01:21:21.576577 [debug] [Thread-1 (]: SQL status: SELECT 54966 in 0.374 seconds
[0m01:21:21.580117 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:21:21.580653 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_patient"} */
alter table "healthcare"."public_warehouse"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m01:21:21.581572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:21:21.583267 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: COMMIT
[0m01:21:21.583790 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:21:21.584313 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: COMMIT
[0m01:21:21.601116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m01:21:21.603687 [debug] [Thread-1 (]: Applying DROP to: "healthcare"."public_warehouse"."dim_patient__dbt_backup"
[0m01:21:21.604739 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:21:21.605284 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_patient"} */
drop table if exists "healthcare"."public_warehouse"."dim_patient__dbt_backup" cascade
[0m01:21:21.606070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:21:21.607458 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: Close
[0m01:21:21.608319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922a787290>]}
[0m01:21:21.609324 [info ] [Thread-1 (]: 14 of 15 OK created sql table model public_warehouse.dim_patient ............... [[32mSELECT 54966[0m in 0.45s]
[0m01:21:21.610466 [debug] [Thread-1 (]: Finished running node model.healthcare_dw.dim_patient
[0m01:21:21.611666 [debug] [Thread-2 (]: Began running node model.healthcare_dw.fact_admissions
[0m01:21:21.612562 [info ] [Thread-2 (]: 15 of 15 START sql table model public_warehouse.fact_admissions ................ [RUN]
[0m01:21:21.613239 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.dim_medication, now model.healthcare_dw.fact_admissions)
[0m01:21:21.613756 [debug] [Thread-2 (]: Began compiling node model.healthcare_dw.fact_admissions
[0m01:21:21.619131 [debug] [Thread-2 (]: Writing injected SQL for node "model.healthcare_dw.fact_admissions"
[0m01:21:21.619829 [debug] [Thread-2 (]: Began executing node model.healthcare_dw.fact_admissions
[0m01:21:21.623740 [debug] [Thread-2 (]: Writing runtime sql for node "model.healthcare_dw.fact_admissions"
[0m01:21:21.624480 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:21:21.625013 [debug] [Thread-2 (]: On model.healthcare_dw.fact_admissions: BEGIN
[0m01:21:21.625512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:21.632494 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m01:21:21.633083 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:21:21.633675 [debug] [Thread-2 (]: On model.healthcare_dw.fact_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.fact_admissions"} */

  
    

  create  table "healthcare"."public_warehouse"."fact_admissions__dbt_tmp"
  
  
    as
  
  (
    -- Fact Table: Admissions
-- Grain: One row per hospital admission event
-- Contains foreign keys to all dimensions and measures

WITH staged_admissions AS (
    SELECT * FROM "healthcare"."public_staging"."stg_admissions"
),

-- Get dimension keys via lookups
dim_patient AS (
    SELECT patient_key, patient_id FROM "healthcare"."public_warehouse"."dim_patient"
),

dim_doctor AS (
    SELECT doctor_key, doctor_id FROM "healthcare"."public_warehouse"."dim_doctor"
),

dim_hospital AS (
    SELECT hospital_key, hospital_id FROM "healthcare"."public_warehouse"."dim_hospital"
),

dim_insurance AS (
    SELECT insurance_key, insurance_id FROM "healthcare"."public_warehouse"."dim_insurance"
),

dim_condition AS (
    SELECT condition_key, condition_id FROM "healthcare"."public_warehouse"."dim_condition"
),

dim_medication AS (
    SELECT medication_key, medication_id FROM "healthcare"."public_warehouse"."dim_medication"
),

-- Calculate readmission flag
admissions_with_readmission AS (
    SELECT 
        a.*,
        LAG(a.discharge_date) OVER (
            PARTITION BY a.patient_id 
            ORDER BY a.date_of_admission
        ) AS previous_discharge_date
    FROM staged_admissions a
)

SELECT
    -- Surrogate key
    ROW_NUMBER() OVER (ORDER BY a.admission_id) AS admission_key,
    
    -- Dimension foreign keys
    COALESCE(p.patient_key, -1) AS patient_key,
    COALESCE(d.doctor_key, -1) AS doctor_key,
    COALESCE(h.hospital_key, -1) AS hospital_key,
    COALESCE(i.insurance_key, -1) AS insurance_key,
    COALESCE(c.condition_key, -1) AS condition_key,
    COALESCE(m.medication_key, -1) AS medication_key,
    
    -- Date dimension keys (role-playing)
    a.admission_date_key,
    a.discharge_date_key,
    
    -- Degenerate dimensions
    a.admission_type,
    a.room_number,
    a.test_results,
    
    -- Measures
    a.billing_amount,
    a.length_of_stay,
    
    -- Derived: Is Readmission (within 30 days of previous discharge)
    CASE 
        WHEN a.previous_discharge_date IS NOT NULL 
         AND (a.date_of_admission - a.previous_discharge_date) <= 30
        THEN TRUE
        ELSE FALSE
    END AS is_readmission,
    
    -- Audit columns
    a.date_of_admission AS admission_date,
    a.discharge_date

FROM admissions_with_readmission a
LEFT JOIN dim_patient p ON a.patient_id = p.patient_id
LEFT JOIN dim_doctor d ON a.doctor_id = d.doctor_id
LEFT JOIN dim_hospital h ON a.hospital_id = h.hospital_id
LEFT JOIN dim_insurance i ON a.insurance_id = i.insurance_id
LEFT JOIN dim_condition c ON a.condition_id = c.condition_id
LEFT JOIN dim_medication m ON a.medication_id = m.medication_id
  );
  
[0m01:21:22.083461 [debug] [Thread-2 (]: SQL status: SELECT 55500 in 0.449 seconds
[0m01:21:22.087391 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:21:22.087993 [debug] [Thread-2 (]: On model.healthcare_dw.fact_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.fact_admissions"} */
alter table "healthcare"."public_warehouse"."fact_admissions__dbt_tmp" rename to "fact_admissions"
[0m01:21:22.088996 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:21:22.090682 [debug] [Thread-2 (]: On model.healthcare_dw.fact_admissions: COMMIT
[0m01:21:22.091230 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:21:22.091728 [debug] [Thread-2 (]: On model.healthcare_dw.fact_admissions: COMMIT
[0m01:21:22.124367 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m01:21:22.128715 [debug] [Thread-2 (]: Applying DROP to: "healthcare"."public_warehouse"."fact_admissions__dbt_backup"
[0m01:21:22.129788 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:21:22.130332 [debug] [Thread-2 (]: On model.healthcare_dw.fact_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.fact_admissions"} */
drop table if exists "healthcare"."public_warehouse"."fact_admissions__dbt_backup" cascade
[0m01:21:22.131152 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m01:21:22.132564 [debug] [Thread-2 (]: On model.healthcare_dw.fact_admissions: Close
[0m01:21:22.133453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfe133e-6209-4853-8f6e-0252ef1b2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922a7d57f0>]}
[0m01:21:22.134465 [info ] [Thread-2 (]: 15 of 15 OK created sql table model public_warehouse.fact_admissions ........... [[32mSELECT 55500[0m in 0.52s]
[0m01:21:22.135584 [debug] [Thread-2 (]: Finished running node model.healthcare_dw.fact_admissions
[0m01:21:22.137743 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:22.138384 [debug] [MainThread]: On master: BEGIN
[0m01:21:22.139408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:21:22.152680 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:21:22.153185 [debug] [MainThread]: On master: COMMIT
[0m01:21:22.153649 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:22.154121 [debug] [MainThread]: On master: COMMIT
[0m01:21:22.154757 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:21:22.155293 [debug] [MainThread]: On master: Close
[0m01:21:22.155899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:22.156521 [debug] [MainThread]: Connection 'model.healthcare_dw.fact_admissions' was properly closed.
[0m01:21:22.157114 [debug] [MainThread]: Connection 'model.healthcare_dw.dim_patient' was properly closed.
[0m01:21:22.157641 [debug] [MainThread]: Connection 'model.healthcare_dw.dim_hospital' was properly closed.
[0m01:21:22.158268 [debug] [MainThread]: Connection 'model.healthcare_dw.dim_doctor' was properly closed.
[0m01:21:22.158866 [info ] [MainThread]: 
[0m01:21:22.159463 [info ] [MainThread]: Finished running 8 table models, 7 view models in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m01:21:22.162234 [debug] [MainThread]: Command end result
[0m01:21:22.197822 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/manifest.json
[0m01:21:22.200047 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/semantic_manifest.json
[0m01:21:22.207200 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/run_results.json
[0m01:21:22.207661 [info ] [MainThread]: 
[0m01:21:22.208260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:21:22.208779 [info ] [MainThread]: 
[0m01:21:22.209373 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m01:21:22.210111 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:21:22.211241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6686354, "process_in_blocks": "1880", "process_kernel_time": 0.403431, "process_mem_max_rss": "150876", "process_out_blocks": "4112", "process_user_time": 5.912363}
[0m01:21:22.211835 [debug] [MainThread]: Command `dbt run` succeeded at 01:21:22.211727 after 4.67 seconds
[0m01:21:22.212344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92455599a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92413c0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92465b2b10>]}
[0m01:21:22.212850 [debug] [MainThread]: Flushing usage events
[0m01:21:22.258445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:21:40.332063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489d80f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489c5f07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489b9ff320>]}


============================== 01:21:40.335373 | f993a346-87b0-4861-86b1-841c52aa0a11 ==============================
[0m01:21:40.335373 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:21:40.336165 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'empty': 'None', 'profiles_dir': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'log_path': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/logs', 'invocation_command': 'dbt test', 'no_print': 'None', 'log_format': 'default'}
[0m01:21:40.623905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f993a346-87b0-4861-86b1-841c52aa0a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489b5bc9b0>]}
[0m01:21:40.711083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f993a346-87b0-4861-86b1-841c52aa0a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489b5bd250>]}
[0m01:21:40.712296 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:21:40.889359 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:21:41.011577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:21:41.012080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:21:41.063028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f993a346-87b0-4861-86b1-841c52aa0a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489a9c3050>]}
[0m01:21:41.160077 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/manifest.json
[0m01:21:41.162142 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/semantic_manifest.json
[0m01:21:41.188555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f993a346-87b0-4861-86b1-841c52aa0a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48995a4fe0>]}
[0m01:21:41.189134 [info ] [MainThread]: Found 15 models, 39 data tests, 7 sources, 459 macros
[0m01:21:41.189703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f993a346-87b0-4861-86b1-841c52aa0a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489a97d790>]}
[0m01:21:41.193904 [info ] [MainThread]: 
[0m01:21:41.194557 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:21:41.195095 [info ] [MainThread]: 
[0m01:21:41.195904 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:21:41.202189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_healthcare_public_staging'
[0m01:21:41.291353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_healthcare_public_warehouse'
[0m01:21:41.337919 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public_staging"
[0m01:21:41.338501 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public_warehouse"
[0m01:21:41.338939 [debug] [ThreadPool]: On list_healthcare_public_staging: BEGIN
[0m01:21:41.339446 [debug] [ThreadPool]: On list_healthcare_public_warehouse: BEGIN
[0m01:21:41.341035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:41.340010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:41.355725 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m01:21:41.356440 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public_staging"
[0m01:21:41.358737 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m01:21:41.359217 [debug] [ThreadPool]: On list_healthcare_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare_public_staging"} */
select
      'healthcare' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'healthcare' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'healthcare' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:21:41.359709 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public_warehouse"
[0m01:21:41.360443 [debug] [ThreadPool]: On list_healthcare_public_warehouse: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare_public_warehouse"} */
select
      'healthcare' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_warehouse'
    union all
    select
      'healthcare' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_warehouse'
    union all
    select
      'healthcare' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_warehouse'
  
[0m01:21:41.364400 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m01:21:41.364945 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m01:21:41.366478 [debug] [ThreadPool]: On list_healthcare_public_staging: ROLLBACK
[0m01:21:41.367881 [debug] [ThreadPool]: On list_healthcare_public_warehouse: ROLLBACK
[0m01:21:41.368710 [debug] [ThreadPool]: On list_healthcare_public_staging: Close
[0m01:21:41.369254 [debug] [ThreadPool]: On list_healthcare_public_warehouse: Close
[0m01:21:41.378700 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:41.379233 [debug] [MainThread]: On master: BEGIN
[0m01:21:41.379671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:21:41.386296 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m01:21:41.386791 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:41.387364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:21:41.390488 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m01:21:41.391849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f993a346-87b0-4861-86b1-841c52aa0a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489a99f500>]}
[0m01:21:41.392475 [debug] [MainThread]: On master: ROLLBACK
[0m01:21:41.393127 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:41.393588 [debug] [MainThread]: On master: BEGIN
[0m01:21:41.394476 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:21:41.394983 [debug] [MainThread]: On master: COMMIT
[0m01:21:41.395458 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:41.395917 [debug] [MainThread]: On master: COMMIT
[0m01:21:41.396579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:21:41.397060 [debug] [MainThread]: On master: Close
[0m01:21:41.400482 [debug] [Thread-1 (]: Began running node test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521
[0m01:21:41.401019 [debug] [Thread-2 (]: Began running node test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052
[0m01:21:41.401576 [debug] [Thread-3 (]: Began running node test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686
[0m01:21:41.402530 [debug] [Thread-4 (]: Began running node test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df
[0m01:21:41.402094 [info ] [Thread-1 (]: 1 of 39 START test accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious  [RUN]
[0m01:21:41.403318 [info ] [Thread-2 (]: 2 of 39 START test accepted_values_dim_condition_severity_level__Low__Medium__High__Critical  [RUN]
[0m01:21:41.403986 [info ] [Thread-3 (]: 3 of 39 START test accepted_values_dim_date_season__Spring__Summer__Fall__Winter  [RUN]
[0m01:21:41.404626 [info ] [Thread-4 (]: 4 of 39 START test accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay  [RUN]
[0m01:21:41.405299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_healthcare_public_staging, now test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521)
[0m01:21:41.405866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_healthcare_public_warehouse, now test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052)
[0m01:21:41.406531 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686'
[0m01:21:41.407164 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df'
[0m01:21:41.409593 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df
[0m01:21:41.407711 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521
[0m01:21:41.408909 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686
[0m01:21:41.408366 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052
[0m01:21:41.435153 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df"
[0m01:21:41.437648 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521"
[0m01:21:41.444109 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"
[0m01:21:41.452448 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052"
[0m01:21:41.453296 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521
[0m01:21:41.454184 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686
[0m01:21:41.471453 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052
[0m01:21:41.474938 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521"
[0m01:21:41.477464 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"
[0m01:21:41.478007 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df
[0m01:21:41.480473 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052"
[0m01:21:41.483515 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df"
[0m01:21:41.484261 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"
[0m01:21:41.484780 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521"
[0m01:21:41.487705 [debug] [Thread-1 (]: On test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521: BEGIN
[0m01:21:41.486381 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df"
[0m01:21:41.489432 [debug] [Thread-4 (]: On test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df: BEGIN
[0m01:21:41.485643 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052"
[0m01:21:41.491225 [debug] [Thread-2 (]: On test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052: BEGIN
[0m01:21:41.486909 [debug] [Thread-3 (]: On test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686: BEGIN
[0m01:21:41.494489 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:21:41.488494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:41.490228 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:21:41.492128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:41.508162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m01:21:41.508908 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"
[0m01:21:41.509717 [debug] [Thread-3 (]: On test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        season as value_field,
        count(*) as n_records

    from "healthcare"."public_warehouse"."dim_date"
    group by season

)

select *
from all_values
where value_field not in (
    'Spring','Summer','Fall','Winter'
)



  
  
      
    ) dbt_internal_test
[0m01:21:41.512510 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:21:41.520387 [debug] [Thread-3 (]: On test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686: ROLLBACK
[0m01:21:41.522134 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m01:21:41.522757 [debug] [Thread-3 (]: On test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686: Close
[0m01:21:41.523273 [debug] [Thread-4 (]: SQL status: BEGIN in 0.033 seconds
[0m01:21:41.525761 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df"
[0m01:21:41.523737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m01:21:41.526531 [debug] [Thread-4 (]: On test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        provider_type as value_field,
        count(*) as n_records

    from "healthcare"."public_warehouse"."dim_insurance"
    group by provider_type

)

select *
from all_values
where value_field not in (
    'Private','Government','Self-Pay'
)



  
  
      
    ) dbt_internal_test
[0m01:21:41.524223 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052"
[0m01:21:41.528550 [debug] [Thread-2 (]: On test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        severity_level as value_field,
        count(*) as n_records

    from "healthcare"."public_warehouse"."dim_condition"
    group by severity_level

)

select *
from all_values
where value_field not in (
    'Low','Medium','High','Critical'
)



  
  
      
    ) dbt_internal_test
[0m01:21:41.527432 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521"
[0m01:21:41.525134 [info ] [Thread-3 (]: 3 of 39 PASS accepted_values_dim_date_season__Spring__Summer__Fall__Winter ..... [[32mPASS[0m in 0.12s]
[0m01:21:41.530480 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:21:41.529597 [debug] [Thread-1 (]: On test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        condition_category as value_field,
        count(*) as n_records

    from "healthcare"."public_warehouse"."dim_condition"
    group by condition_category

)

select *
from all_values
where value_field not in (
    'Chronic','Acute','Infectious'
)



  
  
      
    ) dbt_internal_test
[0m01:21:41.531555 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686
[0m01:21:41.532139 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:21:41.534442 [debug] [Thread-4 (]: On test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df: ROLLBACK
[0m01:21:41.535406 [debug] [Thread-3 (]: Began running node test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84
[0m01:21:41.537347 [debug] [Thread-2 (]: On test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052: ROLLBACK
[0m01:21:41.538039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:21:41.538710 [info ] [Thread-3 (]: 5 of 39 START test accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior  [RUN]
[0m01:21:41.539325 [debug] [Thread-4 (]: On test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df: Close
[0m01:21:41.540942 [debug] [Thread-1 (]: On test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521: ROLLBACK
[0m01:21:41.541444 [debug] [Thread-2 (]: On test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052: Close
[0m01:21:41.544118 [info ] [Thread-2 (]: 2 of 39 PASS accepted_values_dim_condition_severity_level__Low__Medium__High__Critical  [[32mPASS[0m in 0.14s]
[0m01:21:41.545885 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052
[0m01:21:41.542048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686, now test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84)
[0m01:21:41.544933 [debug] [Thread-1 (]: On test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521: Close
[0m01:21:41.543062 [info ] [Thread-4 (]: 4 of 39 PASS accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay  [[32mPASS[0m in 0.14s]
[0m01:21:41.549773 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df
[0m01:21:41.546761 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7
[0m01:21:41.548603 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84
[0m01:21:41.550620 [debug] [Thread-4 (]: Began running node test.healthcare_dw.not_null_dim_condition_condition_key.403465481c
[0m01:21:41.551517 [info ] [Thread-1 (]: 1 of 39 PASS accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious  [[32mPASS[0m in 0.15s]
[0m01:21:41.552126 [info ] [Thread-2 (]: 6 of 39 START test not_null_dim_condition_condition_id ......................... [RUN]
[0m01:21:41.562115 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84"
[0m01:21:41.562611 [info ] [Thread-4 (]: 7 of 39 START test not_null_dim_condition_condition_key ........................ [RUN]
[0m01:21:41.563448 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521
[0m01:21:41.564038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.accepted_values_dim_condition_severity_level__Low__Medium__High__Critical.1293b0f052, now test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7)
[0m01:21:41.564786 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84
[0m01:21:41.565312 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.accepted_values_dim_insurance_provider_type__Private__Government__Self_Pay.51a4a460df, now test.healthcare_dw.not_null_dim_condition_condition_key.403465481c)
[0m01:21:41.570009 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.not_null_dim_condition_condition_key.403465481c
[0m01:21:41.566478 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7
[0m01:21:41.569119 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84"
[0m01:21:41.565882 [debug] [Thread-1 (]: Began running node test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6
[0m01:21:41.579132 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"
[0m01:21:41.584736 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7"
[0m01:21:41.585585 [info ] [Thread-1 (]: 8 of 39 START test not_null_dim_date_date_key .................................. [RUN]
[0m01:21:41.586263 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84"
[0m01:21:41.587109 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.not_null_dim_condition_condition_key.403465481c
[0m01:21:41.587658 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7
[0m01:21:41.588426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.accepted_values_dim_condition_condition_category__Chronic__Acute__Infectious.c5d3952521, now test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6)
[0m01:21:41.597739 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6
[0m01:21:41.589428 [debug] [Thread-3 (]: On test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84: BEGIN
[0m01:21:41.596850 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7"
[0m01:21:41.593744 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"
[0m01:21:41.603222 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"
[0m01:21:41.606408 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6
[0m01:21:41.603830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:41.605508 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"
[0m01:21:41.604631 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7"
[0m01:21:41.611657 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7: BEGIN
[0m01:21:41.612400 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:41.609965 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"
[0m01:21:41.613708 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"
[0m01:21:41.610828 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_condition_condition_key.403465481c: BEGIN
[0m01:21:41.615830 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:41.614534 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6: BEGIN
[0m01:21:41.617278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:41.629197 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m01:21:41.630661 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84"
[0m01:21:41.631852 [debug] [Thread-3 (]: On test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        age_group as value_field,
        count(*) as n_records

    from "healthcare"."public_warehouse"."dim_patient"
    group by age_group

)

select *
from all_values
where value_field not in (
    'Pediatric','Young Adult','Middle Age','Senior'
)



  
  
      
    ) dbt_internal_test
[0m01:21:41.634261 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m01:21:41.635045 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7"
[0m01:21:41.635851 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select condition_id
from "healthcare"."public_warehouse"."dim_condition"
where condition_id is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.637871 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:21:41.640914 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7: ROLLBACK
[0m01:21:41.641677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m01:21:41.643064 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"
[0m01:21:41.645328 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "healthcare"."public_warehouse"."dim_date"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.644498 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7: Close
[0m01:21:41.643734 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m01:21:41.646472 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"
[0m01:21:41.647283 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_condition_condition_key.403465481c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select condition_key
from "healthcare"."public_warehouse"."dim_condition"
where condition_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.648369 [info ] [Thread-2 (]: 6 of 39 PASS not_null_dim_condition_condition_id ............................... [[32mPASS[0m in 0.08s]
[0m01:21:41.649410 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7
[0m01:21:41.651768 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5
[0m01:21:41.653212 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:21:41.652510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m01:21:41.657249 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_condition_condition_key.403465481c: ROLLBACK
[0m01:21:41.659207 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6: ROLLBACK
[0m01:21:41.654936 [info ] [Thread-2 (]: 9 of 39 START test not_null_dim_doctor_doctor_id ............................... [RUN]
[0m01:21:41.659981 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.027 seconds
[0m01:21:41.660777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_condition_condition_id.5d9da36fe7, now test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5)
[0m01:21:41.661398 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_condition_condition_key.403465481c: Close
[0m01:21:41.661870 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6: Close
[0m01:21:41.664274 [debug] [Thread-3 (]: On test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84: ROLLBACK
[0m01:21:41.664902 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5
[0m01:21:41.665800 [info ] [Thread-4 (]: 7 of 39 PASS not_null_dim_condition_condition_key .............................. [[32mPASS[0m in 0.10s]
[0m01:21:41.666724 [info ] [Thread-1 (]: 8 of 39 PASS not_null_dim_date_date_key ........................................ [[32mPASS[0m in 0.08s]
[0m01:21:41.673716 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.not_null_dim_condition_condition_key.403465481c
[0m01:21:41.675776 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5"
[0m01:21:41.676860 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6
[0m01:21:41.677895 [debug] [Thread-4 (]: Began running node test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f
[0m01:21:41.678480 [debug] [Thread-3 (]: On test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84: Close
[0m01:21:41.679277 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5
[0m01:21:41.679789 [debug] [Thread-1 (]: Began running node test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b
[0m01:21:41.686874 [info ] [Thread-1 (]: 11 of 39 START test not_null_dim_hospital_hospital_id .......................... [RUN]
[0m01:21:41.687932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6, now test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b)
[0m01:21:41.680413 [info ] [Thread-4 (]: 10 of 39 START test not_null_dim_doctor_doctor_key ............................. [RUN]
[0m01:21:41.689737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_condition_condition_key.403465481c, now test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f)
[0m01:21:41.681422 [info ] [Thread-3 (]: 5 of 39 PASS accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior  [[32mPASS[0m in 0.14s]
[0m01:21:41.685943 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5"
[0m01:21:41.692661 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5"
[0m01:21:41.690652 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f
[0m01:21:41.691587 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84
[0m01:21:41.688865 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b
[0m01:21:41.693501 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m01:21:41.698892 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"
[0m01:21:41.699578 [debug] [Thread-3 (]: Began running node test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703
[0m01:21:41.705360 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b"
[0m01:21:41.705929 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:41.706722 [info ] [Thread-3 (]: 12 of 39 START test not_null_dim_hospital_hospital_key ......................... [RUN]
[0m01:21:41.707449 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f
[0m01:21:41.709701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.accepted_values_dim_patient_age_group__Pediatric__Young_Adult__Middle_Age__Senior.744ea6fe84, now test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703)
[0m01:21:41.708839 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b
[0m01:21:41.716262 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703
[0m01:21:41.715269 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"
[0m01:21:41.722981 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b"
[0m01:21:41.729368 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"
[0m01:21:41.730255 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"
[0m01:21:41.730747 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m01:21:41.731486 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f: BEGIN
[0m01:21:41.732347 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b"
[0m01:21:41.732812 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5"
[0m01:21:41.733419 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:41.733871 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703
[0m01:21:41.734434 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b: BEGIN
[0m01:21:41.741089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:41.735011 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select doctor_id
from "healthcare"."public_warehouse"."dim_doctor"
where doctor_id is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.740036 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"
[0m01:21:41.745535 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"
[0m01:21:41.746505 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703: BEGIN
[0m01:21:41.749720 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:41.755229 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m01:21:41.756078 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m01:21:41.760570 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m01:21:41.761526 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"
[0m01:21:41.763569 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select doctor_key
from "healthcare"."public_warehouse"."dim_doctor"
where doctor_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.764375 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m01:21:41.765561 [info ] [Thread-2 (]: 9 of 39 PASS not_null_dim_doctor_doctor_id ..................................... [[32mPASS[0m in 0.10s]
[0m01:21:41.767787 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5
[0m01:21:41.768584 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a
[0m01:21:41.769349 [info ] [Thread-2 (]: 13 of 39 START test not_null_dim_insurance_insurance_id ........................ [RUN]
[0m01:21:41.770469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_doctor_doctor_id.608c9150a5, now test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a)
[0m01:21:41.772191 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m01:21:41.774076 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"
[0m01:21:41.771250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m01:21:41.773144 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a
[0m01:21:41.775080 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hospital_key
from "healthcare"."public_warehouse"."dim_hospital"
where hospital_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.775945 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b"
[0m01:21:41.781857 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hospital_id
from "healthcare"."public_warehouse"."dim_hospital"
where hospital_id is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.781057 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a"
[0m01:21:41.783226 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a
[0m01:21:41.776749 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m01:21:41.789395 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a"
[0m01:21:41.791581 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f: ROLLBACK
[0m01:21:41.792810 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a"
[0m01:21:41.793456 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m01:21:41.794625 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f: Close
[0m01:21:41.795581 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m01:21:41.796270 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a: BEGIN
[0m01:21:41.797772 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b: ROLLBACK
[0m01:21:41.799841 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703: ROLLBACK
[0m01:21:41.800636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:41.801495 [info ] [Thread-4 (]: 10 of 39 PASS not_null_dim_doctor_doctor_key ................................... [[32mPASS[0m in 0.11s]
[0m01:21:41.802363 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b: Close
[0m01:21:41.803554 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f
[0m01:21:41.806078 [debug] [Thread-4 (]: Began running node test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5
[0m01:21:41.804285 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703: Close
[0m01:21:41.805422 [info ] [Thread-1 (]: 11 of 39 PASS not_null_dim_hospital_hospital_id ................................ [[32mPASS[0m in 0.12s]
[0m01:21:41.810910 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b
[0m01:21:41.806870 [info ] [Thread-4 (]: 14 of 39 START test not_null_dim_insurance_insurance_key ....................... [RUN]
[0m01:21:41.814795 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f, now test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5)
[0m01:21:41.812820 [debug] [Thread-1 (]: Began running node test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f
[0m01:21:41.808287 [info ] [Thread-3 (]: 12 of 39 PASS not_null_dim_hospital_hospital_key ............................... [[32mPASS[0m in 0.10s]
[0m01:21:41.815636 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5
[0m01:21:41.820219 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703
[0m01:21:41.827125 [debug] [Thread-3 (]: Began running node test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9
[0m01:21:41.825853 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"
[0m01:21:41.817998 [info ] [Thread-1 (]: 15 of 39 START test not_null_dim_medication_medication_id ...................... [RUN]
[0m01:21:41.828540 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m01:21:41.829355 [info ] [Thread-3 (]: 16 of 39 START test not_null_dim_medication_medication_key ..................... [RUN]
[0m01:21:41.830250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_hospital_hospital_id.8d66b4ae4b, now test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f)
[0m01:21:41.830886 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5
[0m01:21:41.831399 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a"
[0m01:21:41.831980 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703, now test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9)
[0m01:21:41.832686 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f
[0m01:21:41.836454 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"
[0m01:21:41.837358 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select insurance_id
from "healthcare"."public_warehouse"."dim_insurance"
where insurance_id is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.838351 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9
[0m01:21:41.842616 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f"
[0m01:21:41.848621 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"
[0m01:21:41.849291 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m01:21:41.849811 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"
[0m01:21:41.856216 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5: BEGIN
[0m01:21:41.854016 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a: ROLLBACK
[0m01:21:41.854857 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9
[0m01:21:41.850590 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f
[0m01:21:41.857145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:41.865908 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f"
[0m01:21:41.862973 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"
[0m01:21:41.867034 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a: Close
[0m01:21:41.871896 [info ] [Thread-2 (]: 13 of 39 PASS not_null_dim_insurance_insurance_id .............................. [[32mPASS[0m in 0.10s]
[0m01:21:41.870871 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"
[0m01:21:41.873783 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9: BEGIN
[0m01:21:41.869280 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f"
[0m01:21:41.875497 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f: BEGIN
[0m01:21:41.872994 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a
[0m01:21:41.877161 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d
[0m01:21:41.874610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:41.876328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:41.877912 [info ] [Thread-2 (]: 17 of 39 START test not_null_dim_patient_patient_id ............................ [RUN]
[0m01:21:41.880734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_insurance_insurance_id.e3aaa1e39a, now test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d)
[0m01:21:41.881613 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d
[0m01:21:41.889629 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d"
[0m01:21:41.892218 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d
[0m01:21:41.896568 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d"
[0m01:21:41.897819 [debug] [Thread-4 (]: SQL status: BEGIN in 0.040 seconds
[0m01:21:41.898523 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m01:21:41.899478 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"
[0m01:21:41.900414 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"
[0m01:21:41.901353 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d"
[0m01:21:41.902001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m01:21:41.902481 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select insurance_key
from "healthcare"."public_warehouse"."dim_insurance"
where insurance_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.903094 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select medication_key
from "healthcare"."public_warehouse"."dim_medication"
where medication_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.903662 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m01:21:41.904229 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f"
[0m01:21:41.905060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:41.906000 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:21:41.906696 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select medication_id
from "healthcare"."public_warehouse"."dim_medication"
where medication_id is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.907203 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:21:41.909859 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9: ROLLBACK
[0m01:21:41.912523 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5: ROLLBACK
[0m01:21:41.913892 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:21:41.915327 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5: Close
[0m01:21:41.917631 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f: ROLLBACK
[0m01:21:41.914632 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9: Close
[0m01:21:41.924177 [info ] [Thread-3 (]: 16 of 39 PASS not_null_dim_medication_medication_key ........................... [[32mPASS[0m in 0.09s]
[0m01:21:41.925381 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9
[0m01:21:41.919891 [info ] [Thread-4 (]: 14 of 39 PASS not_null_dim_insurance_insurance_key ............................. [[32mPASS[0m in 0.10s]
[0m01:21:41.922909 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m01:21:41.928039 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5
[0m01:21:41.927044 [debug] [Thread-3 (]: Began running node test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d
[0m01:21:41.926201 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f: Close
[0m01:21:41.928909 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d"
[0m01:21:41.929783 [debug] [Thread-4 (]: Began running node test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9
[0m01:21:41.932395 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "healthcare"."public_warehouse"."dim_patient"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m01:21:41.931270 [info ] [Thread-1 (]: 15 of 39 PASS not_null_dim_medication_medication_id ............................ [[32mPASS[0m in 0.10s]
[0m01:21:41.934502 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f
[0m01:21:41.930455 [info ] [Thread-3 (]: 18 of 39 START test not_null_dim_patient_patient_key ........................... [RUN]
[0m01:21:41.933299 [info ] [Thread-4 (]: 19 of 39 START test not_null_fact_admissions_admission_key ..................... [RUN]
[0m01:21:41.935317 [debug] [Thread-1 (]: Began running node test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402
[0m01:21:41.936300 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9, now test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d)
[0m01:21:41.940018 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d
[0m01:21:41.937126 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5, now test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9)
[0m01:21:41.946069 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9
[0m01:21:41.938242 [info ] [Thread-1 (]: 20 of 39 START test not_null_fact_admissions_billing_amount .................... [RUN]
[0m01:21:41.945444 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"
[0m01:21:41.947277 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m01:21:41.951416 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"
[0m01:21:41.952048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_medication_medication_id.815ab7ea4f, now test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402)
[0m01:21:41.953745 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m01:21:41.954239 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d
[0m01:21:41.954908 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9
[0m01:21:41.955503 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402
[0m01:21:41.958286 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"
[0m01:21:41.968815 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"
[0m01:21:41.962392 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"
[0m01:21:41.967769 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"
[0m01:21:41.958865 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d: Close
[0m01:21:41.969664 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d: BEGIN
[0m01:21:41.975142 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:41.970675 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"
[0m01:21:41.976071 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9: BEGIN
[0m01:21:41.972781 [info ] [Thread-2 (]: 17 of 39 PASS not_null_dim_patient_patient_id .................................. [[32mPASS[0m in 0.09s]
[0m01:21:41.979286 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d
[0m01:21:41.978244 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:41.971504 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402
[0m01:21:41.980211 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e
[0m01:21:41.988251 [info ] [Thread-2 (]: 21 of 39 START test not_null_fact_admissions_doctor_key ........................ [RUN]
[0m01:21:41.989077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_patient_patient_id.57b243776d, now test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e)
[0m01:21:41.986470 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"
[0m01:21:41.994737 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"
[0m01:21:41.989762 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e
[0m01:21:41.995509 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402: BEGIN
[0m01:21:42.003647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:42.007376 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e"
[0m01:21:42.008374 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e
[0m01:21:42.012627 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e"
[0m01:21:42.013372 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m01:21:42.022275 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"
[0m01:21:42.014414 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m01:21:42.026290 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"
[0m01:21:42.017469 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e"
[0m01:21:42.030284 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e: BEGIN
[0m01:21:42.031124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:42.023084 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_key
from "healthcare"."public_warehouse"."dim_patient"
where patient_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:42.027160 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select admission_key
from "healthcare"."public_warehouse"."fact_admissions"
where admission_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:42.037485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m01:21:42.038444 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"
[0m01:21:42.040205 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select billing_amount
from "healthcare"."public_warehouse"."fact_admissions"
where billing_amount is null



  
  
      
    ) dbt_internal_test
[0m01:21:42.050696 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m01:21:42.051507 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e"
[0m01:21:42.052648 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select doctor_key
from "healthcare"."public_warehouse"."fact_admissions"
where doctor_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:42.065234 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m01:21:42.068694 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e: ROLLBACK
[0m01:21:42.070420 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.034 seconds
[0m01:21:42.073072 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d: ROLLBACK
[0m01:21:42.073802 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e: Close
[0m01:21:42.074767 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.038 seconds
[0m01:21:42.082714 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d: Close
[0m01:21:42.081266 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9: ROLLBACK
[0m01:21:42.082096 [info ] [Thread-2 (]: 21 of 39 PASS not_null_fact_admissions_doctor_key .............................. [[32mPASS[0m in 0.09s]
[0m01:21:42.084733 [info ] [Thread-3 (]: 18 of 39 PASS not_null_dim_patient_patient_key ................................. [[32mPASS[0m in 0.15s]
[0m01:21:42.086188 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m01:21:42.087842 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e
[0m01:21:42.094091 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660
[0m01:21:42.091292 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9: Close
[0m01:21:42.089046 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d
[0m01:21:42.095985 [debug] [Thread-3 (]: Began running node test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c
[0m01:21:42.094892 [info ] [Thread-2 (]: 22 of 39 START test not_null_fact_admissions_hospital_key ...................... [RUN]
[0m01:21:42.093319 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402: ROLLBACK
[0m01:21:42.096832 [info ] [Thread-3 (]: 23 of 39 START test not_null_fact_admissions_is_readmission .................... [RUN]
[0m01:21:42.099369 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d, now test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c)
[0m01:21:42.100098 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c
[0m01:21:42.098215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_fact_admissions_doctor_key.711cdb2e7e, now test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660)
[0m01:21:42.107144 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660
[0m01:21:42.106080 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402: Close
[0m01:21:42.097563 [info ] [Thread-4 (]: 19 of 39 PASS not_null_fact_admissions_admission_key ........................... [[32mPASS[0m in 0.16s]
[0m01:21:42.116513 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9
[0m01:21:42.122704 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660"
[0m01:21:42.119294 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c"
[0m01:21:42.123613 [debug] [Thread-4 (]: Began running node test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1
[0m01:21:42.120263 [info ] [Thread-1 (]: 20 of 39 PASS not_null_fact_admissions_billing_amount .......................... [[32mPASS[0m in 0.17s]
[0m01:21:42.125187 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c
[0m01:21:42.125754 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660
[0m01:21:42.126364 [info ] [Thread-4 (]: 24 of 39 START test not_null_fact_admissions_patient_key ....................... [RUN]
[0m01:21:42.137402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9, now test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1)
[0m01:21:42.131844 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c"
[0m01:21:42.136410 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660"
[0m01:21:42.127353 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402
[0m01:21:42.141083 [debug] [Thread-1 (]: Began running node test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb
[0m01:21:42.138309 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1
[0m01:21:42.140284 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c"
[0m01:21:42.139478 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660"
[0m01:21:42.141943 [info ] [Thread-1 (]: 25 of 39 START test relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_  [RUN]
[0m01:21:42.149751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402, now test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb)
[0m01:21:42.147337 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1"
[0m01:21:42.148885 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660: BEGIN
[0m01:21:42.148035 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c: BEGIN
[0m01:21:42.150636 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb
[0m01:21:42.152235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:42.152809 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:42.153296 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1
[0m01:21:42.163523 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb"
[0m01:21:42.170601 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb
[0m01:21:42.169856 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1"
[0m01:21:42.176386 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1"
[0m01:21:42.175279 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb"
[0m01:21:42.178330 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb"
[0m01:21:42.177277 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1: BEGIN
[0m01:21:42.179933 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:42.179210 [debug] [Thread-1 (]: On test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb: BEGIN
[0m01:21:42.181087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:42.185700 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m01:21:42.188294 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c"
[0m01:21:42.189101 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_readmission
from "healthcare"."public_warehouse"."fact_admissions"
where is_readmission is null



  
  
      
    ) dbt_internal_test
[0m01:21:42.194241 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m01:21:42.194943 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660"
[0m01:21:42.195661 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hospital_key
from "healthcare"."public_warehouse"."fact_admissions"
where hospital_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:42.202837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m01:21:42.203738 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb"
[0m01:21:42.206784 [debug] [Thread-1 (]: On test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select patient_key as from_field
    from "healthcare"."public_warehouse"."fact_admissions"
    where patient_key is not null
),

parent as (
    select patient_key as to_field
    from "healthcare"."public_warehouse"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:21:42.208180 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m01:21:42.211061 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c: ROLLBACK
[0m01:21:42.214126 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c: Close
[0m01:21:42.213110 [debug] [Thread-4 (]: SQL status: BEGIN in 0.033 seconds
[0m01:21:42.211920 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m01:21:42.218311 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660: ROLLBACK
[0m01:21:42.215455 [info ] [Thread-3 (]: 23 of 39 PASS not_null_fact_admissions_is_readmission .......................... [[32mPASS[0m in 0.12s]
[0m01:21:42.216094 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1"
[0m01:21:42.220844 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_key
from "healthcare"."public_warehouse"."fact_admissions"
where patient_key is null



  
  
      
    ) dbt_internal_test
[0m01:21:42.219713 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c
[0m01:21:42.222219 [debug] [Thread-3 (]: Began running node test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b
[0m01:21:42.222982 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660: Close
[0m01:21:42.223807 [info ] [Thread-3 (]: 26 of 39 START test unique_dim_condition_condition_id .......................... [RUN]
[0m01:21:42.225819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_fact_admissions_is_readmission.1365caae9c, now test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b)
[0m01:21:42.226577 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b
[0m01:21:42.224804 [info ] [Thread-2 (]: 22 of 39 PASS not_null_fact_admissions_hospital_key ............................ [[32mPASS[0m in 0.13s]
[0m01:21:42.233635 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660
[0m01:21:42.242775 [debug] [Thread-2 (]: Began running node test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838
[0m01:21:42.243565 [info ] [Thread-2 (]: 27 of 39 START test unique_dim_condition_condition_key ......................... [RUN]
[0m01:21:42.246312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_fact_admissions_hospital_key.b6bbee2660, now test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838)
[0m01:21:42.247191 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838
[0m01:21:42.245495 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b"
[0m01:21:42.254150 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b
[0m01:21:42.248098 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.026 seconds
[0m01:21:42.260427 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1: ROLLBACK
[0m01:21:42.258103 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b"
[0m01:21:42.263457 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b"
[0m01:21:42.262334 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"
[0m01:21:42.264354 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b: BEGIN
[0m01:21:42.265324 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1: Close
[0m01:21:42.266054 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.058 seconds
[0m01:21:42.266557 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:42.267925 [info ] [Thread-4 (]: 24 of 39 PASS not_null_fact_admissions_patient_key ............................. [[32mPASS[0m in 0.13s]
[0m01:21:42.267050 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838
[0m01:21:42.272940 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1
[0m01:21:42.270633 [debug] [Thread-1 (]: On test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb: ROLLBACK
[0m01:21:42.278434 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"
[0m01:21:42.282218 [debug] [Thread-4 (]: Began running node test.healthcare_dw.unique_dim_date_date_key.0869fd48f9
[0m01:21:42.283454 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"
[0m01:21:42.285608 [debug] [Thread-1 (]: On test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb: Close
[0m01:21:42.287315 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m01:21:42.290032 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b"
[0m01:21:42.286678 [info ] [Thread-4 (]: 28 of 39 START test unique_dim_date_date_key ................................... [RUN]
[0m01:21:42.291600 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_fact_admissions_patient_key.2301aff5c1, now test.healthcare_dw.unique_dim_date_date_key.0869fd48f9)
[0m01:21:42.289204 [info ] [Thread-1 (]: 25 of 39 PASS relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_  [[32mPASS[0m in 0.14s]
[0m01:21:42.288279 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838: BEGIN
[0m01:21:42.290799 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    condition_id as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_condition"
where condition_id is not null
group by condition_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.293895 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:42.292409 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.unique_dim_date_date_key.0869fd48f9
[0m01:21:42.293325 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb
[0m01:21:42.302369 [debug] [Thread-1 (]: Began running node test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb
[0m01:21:42.301525 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"
[0m01:21:42.304746 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.unique_dim_date_date_key.0869fd48f9
[0m01:21:42.303726 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m01:21:42.308431 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"
[0m01:21:42.310805 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b: ROLLBACK
[0m01:21:42.313025 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m01:21:42.314031 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"
[0m01:21:42.303193 [info ] [Thread-1 (]: 29 of 39 START test unique_dim_doctor_doctor_id ................................ [RUN]
[0m01:21:42.316633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.relationships_fact_admissions_patient_key__patient_key__ref_dim_patient_.169fc081fb, now test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb)
[0m01:21:42.314892 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    condition_key as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_condition"
where condition_key is not null
group by condition_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.318730 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b: Close
[0m01:21:42.312075 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"
[0m01:21:42.320624 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_date_date_key.0869fd48f9: BEGIN
[0m01:21:42.317466 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb
[0m01:21:42.319930 [info ] [Thread-3 (]: 26 of 39 PASS unique_dim_condition_condition_id ................................ [[32mPASS[0m in 0.09s]
[0m01:21:42.331343 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b
[0m01:21:42.325089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:42.324231 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:21:42.335190 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb"
[0m01:21:42.335725 [debug] [Thread-3 (]: Began running node test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9
[0m01:21:42.340139 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb
[0m01:21:42.338680 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838: ROLLBACK
[0m01:21:42.341123 [info ] [Thread-3 (]: 30 of 39 START test unique_dim_doctor_doctor_key ............................... [RUN]
[0m01:21:42.346393 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_condition_condition_id.626a62f50b, now test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9)
[0m01:21:42.345186 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb"
[0m01:21:42.347166 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9
[0m01:21:42.348583 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838: Close
[0m01:21:42.355106 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"
[0m01:21:42.356882 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9
[0m01:21:42.364316 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb"
[0m01:21:42.356039 [info ] [Thread-2 (]: 27 of 39 PASS unique_dim_condition_condition_key ............................... [[32mPASS[0m in 0.11s]
[0m01:21:42.368360 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838
[0m01:21:42.367309 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m01:21:42.366257 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m01:21:42.362194 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"
[0m01:21:42.371921 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"
[0m01:21:42.370825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:42.369246 [debug] [Thread-2 (]: Began running node test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f
[0m01:21:42.369852 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"
[0m01:21:42.372673 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9: BEGIN
[0m01:21:42.375423 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:42.374342 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_date_date_key.0869fd48f9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_date"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.373614 [info ] [Thread-2 (]: 31 of 39 START test unique_dim_hospital_hospital_id ............................ [RUN]
[0m01:21:42.377364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838, now test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f)
[0m01:21:42.378610 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f
[0m01:21:42.386702 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f"
[0m01:21:42.387636 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f
[0m01:21:42.389213 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m01:21:42.401040 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_date_date_key.0869fd48f9: ROLLBACK
[0m01:21:42.402861 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f"
[0m01:21:42.404362 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f"
[0m01:21:42.405223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m01:21:42.405703 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f: BEGIN
[0m01:21:42.406189 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m01:21:42.406646 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_date_date_key.0869fd48f9: Close
[0m01:21:42.407187 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb"
[0m01:21:42.407729 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:42.408295 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"
[0m01:21:42.411852 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    doctor_key as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_doctor"
where doctor_key is not null
group by doctor_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.409178 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.410664 [info ] [Thread-4 (]: 28 of 39 PASS unique_dim_date_date_key ......................................... [[32mPASS[0m in 0.12s]
[0m01:21:42.416254 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.unique_dim_date_date_key.0869fd48f9
[0m01:21:42.417182 [debug] [Thread-4 (]: Began running node test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c
[0m01:21:42.418861 [info ] [Thread-4 (]: 32 of 39 START test unique_dim_hospital_hospital_key ........................... [RUN]
[0m01:21:42.421033 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_date_date_key.0869fd48f9, now test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c)
[0m01:21:42.427171 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c
[0m01:21:42.439986 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"
[0m01:21:42.441106 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c
[0m01:21:42.445606 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"
[0m01:21:42.446384 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m01:21:42.447361 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f"
[0m01:21:42.448258 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"
[0m01:21:42.449847 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c: BEGIN
[0m01:21:42.449023 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hospital_id as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_hospital"
where hospital_id is not null
group by hospital_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.450626 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:42.467553 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.054 seconds
[0m01:21:42.472032 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m01:21:42.473164 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.060 seconds
[0m01:21:42.475913 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9: ROLLBACK
[0m01:21:42.476720 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m01:21:42.477431 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m01:21:42.479209 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"
[0m01:21:42.478520 [info ] [Thread-1 (]: 29 of 39 PASS unique_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.16s]
[0m01:21:42.482169 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb
[0m01:21:42.480390 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hospital_key as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_hospital"
where hospital_key is not null
group by hospital_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.481154 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9: Close
[0m01:21:42.482934 [debug] [Thread-1 (]: Began running node test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6
[0m01:21:42.484169 [info ] [Thread-3 (]: 30 of 39 PASS unique_dim_doctor_doctor_key ..................................... [[32mPASS[0m in 0.14s]
[0m01:21:42.486433 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9
[0m01:21:42.484942 [info ] [Thread-1 (]: 33 of 39 START test unique_dim_insurance_insurance_id .......................... [RUN]
[0m01:21:42.490431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_doctor_doctor_id.209e4831bb, now test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6)
[0m01:21:42.489487 [debug] [Thread-3 (]: Began running node test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59
[0m01:21:42.491314 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6
[0m01:21:42.492210 [info ] [Thread-3 (]: 34 of 39 START test unique_dim_insurance_insurance_key ......................... [RUN]
[0m01:21:42.499992 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6"
[0m01:21:42.500932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9, now test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59)
[0m01:21:42.502185 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59
[0m01:21:42.502997 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6
[0m01:21:42.513439 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6"
[0m01:21:42.509334 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"
[0m01:21:42.514807 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59
[0m01:21:42.516511 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6"
[0m01:21:42.515625 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.064 seconds
[0m01:21:42.521537 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6: BEGIN
[0m01:21:42.525006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:42.520644 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"
[0m01:21:42.524101 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f: ROLLBACK
[0m01:21:42.526606 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"
[0m01:21:42.527508 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f: Close
[0m01:21:42.528767 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59: BEGIN
[0m01:21:42.530793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:42.530046 [info ] [Thread-2 (]: 31 of 39 PASS unique_dim_hospital_hospital_id .................................. [[32mPASS[0m in 0.15s]
[0m01:21:42.533223 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f
[0m01:21:42.534112 [debug] [Thread-2 (]: Began running node test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11
[0m01:21:42.535509 [info ] [Thread-2 (]: 35 of 39 START test unique_dim_medication_medication_id ........................ [RUN]
[0m01:21:42.537796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_hospital_hospital_id.8713efdb0f, now test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11)
[0m01:21:42.539206 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11
[0m01:21:42.554258 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11"
[0m01:21:42.555450 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11
[0m01:21:42.556276 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.072 seconds
[0m01:21:42.559706 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11"
[0m01:21:42.560245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m01:21:42.562198 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c: ROLLBACK
[0m01:21:42.562702 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m01:21:42.563456 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6"
[0m01:21:42.564044 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11"
[0m01:21:42.564720 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"
[0m01:21:42.565354 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c: Close
[0m01:21:42.565858 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    insurance_id as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_insurance"
where insurance_id is not null
group by insurance_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.566442 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11: BEGIN
[0m01:21:42.568990 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:42.567878 [info ] [Thread-4 (]: 32 of 39 PASS unique_dim_hospital_hospital_key ................................. [[32mPASS[0m in 0.15s]
[0m01:21:42.567022 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    insurance_key as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_insurance"
where insurance_key is not null
group by insurance_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.572146 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:21:42.570719 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c
[0m01:21:42.578153 [debug] [Thread-4 (]: Began running node test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c
[0m01:21:42.574780 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6: ROLLBACK
[0m01:21:42.578992 [info ] [Thread-4 (]: 36 of 39 START test unique_dim_medication_medication_key ....................... [RUN]
[0m01:21:42.577215 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:21:42.580883 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c, now test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c)
[0m01:21:42.580062 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6: Close
[0m01:21:42.583213 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59: ROLLBACK
[0m01:21:42.583885 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c
[0m01:21:42.584854 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m01:21:42.591643 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"
[0m01:21:42.592294 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59: Close
[0m01:21:42.592760 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11"
[0m01:21:42.585850 [info ] [Thread-1 (]: 33 of 39 PASS unique_dim_insurance_insurance_id ................................ [[32mPASS[0m in 0.10s]
[0m01:21:42.593968 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    medication_id as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_medication"
where medication_id is not null
group by medication_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.594986 [info ] [Thread-3 (]: 34 of 39 PASS unique_dim_insurance_insurance_key ............................... [[32mPASS[0m in 0.09s]
[0m01:21:42.598748 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59
[0m01:21:42.599444 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c
[0m01:21:42.597403 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6
[0m01:21:42.600431 [debug] [Thread-3 (]: Began running node test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61
[0m01:21:42.604148 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"
[0m01:21:42.605266 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m01:21:42.606242 [debug] [Thread-1 (]: Began running node test.healthcare_dw.unique_dim_patient_patient_key.b601210326
[0m01:21:42.607033 [info ] [Thread-3 (]: 37 of 39 START test unique_dim_patient_patient_id .............................. [RUN]
[0m01:21:42.608730 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11: ROLLBACK
[0m01:21:42.609402 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"
[0m01:21:42.609878 [info ] [Thread-1 (]: 38 of 39 START test unique_dim_patient_patient_key ............................. [RUN]
[0m01:21:42.612876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_insurance_insurance_id.c47cb7a2d6, now test.healthcare_dw.unique_dim_patient_patient_key.b601210326)
[0m01:21:42.613642 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.unique_dim_patient_patient_key.b601210326
[0m01:21:42.610548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59, now test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61)
[0m01:21:42.619640 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61
[0m01:21:42.611252 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c: BEGIN
[0m01:21:42.612036 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11: Close
[0m01:21:42.624014 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61"
[0m01:21:42.628839 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61
[0m01:21:42.626352 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"
[0m01:21:42.627875 [info ] [Thread-2 (]: 35 of 39 PASS unique_dim_medication_medication_id .............................. [[32mPASS[0m in 0.09s]
[0m01:21:42.626930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:21:42.631934 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61"
[0m01:21:42.632738 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.unique_dim_patient_patient_key.b601210326
[0m01:21:42.633425 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11
[0m01:21:42.639939 [debug] [Thread-2 (]: Began running node test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b
[0m01:21:42.640693 [info ] [Thread-2 (]: 39 of 39 START test unique_fact_admissions_admission_key ....................... [RUN]
[0m01:21:42.639020 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"
[0m01:21:42.643513 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"
[0m01:21:42.642551 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61"
[0m01:21:42.645253 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m01:21:42.641543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_medication_medication_id.d530d65d11, now test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b)
[0m01:21:42.644374 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_patient_patient_key.b601210326: BEGIN
[0m01:21:42.646090 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:21:42.649381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:42.647191 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b
[0m01:21:42.675256 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m01:21:42.676057 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m01:21:42.679495 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"
[0m01:21:42.680280 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    medication_key as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_medication"
where medication_key is not null
group by medication_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.673386 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"
[0m01:21:42.681719 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b
[0m01:21:42.678496 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61"
[0m01:21:42.685172 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"
[0m01:21:42.685798 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:21:42.686298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m01:21:42.686850 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.688897 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c: ROLLBACK
[0m01:21:42.690505 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"
[0m01:21:42.691396 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"
[0m01:21:42.695280 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_patient_patient_key.b601210326: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_key as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."dim_patient"
where patient_key is not null
group by patient_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.696777 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c: Close
[0m01:21:42.692568 [debug] [Thread-2 (]: On test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b: BEGIN
[0m01:21:42.697774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:21:42.700382 [info ] [Thread-4 (]: 36 of 39 PASS unique_dim_medication_medication_key ............................. [[32mPASS[0m in 0.12s]
[0m01:21:42.704342 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c
[0m01:21:42.727130 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m01:21:42.730294 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"
[0m01:21:42.731173 [debug] [Thread-2 (]: On test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    admission_key as unique_field,
    count(*) as n_records

from "healthcare"."public_warehouse"."fact_admissions"
where admission_key is not null
group by admission_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:21:42.759264 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.067 seconds
[0m01:21:42.762084 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m01:21:42.763292 [debug] [Thread-3 (]: On test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61: Close
[0m01:21:42.766538 [info ] [Thread-3 (]: 37 of 39 PASS unique_dim_patient_patient_id .................................... [[32mPASS[0m in 0.16s]
[0m01:21:42.767657 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61
[0m01:21:42.779417 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.083 seconds
[0m01:21:42.781768 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_patient_patient_key.b601210326: ROLLBACK
[0m01:21:42.782806 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_patient_patient_key.b601210326: Close
[0m01:21:42.786465 [info ] [Thread-1 (]: 38 of 39 PASS unique_dim_patient_patient_key ................................... [[32mPASS[0m in 0.17s]
[0m01:21:42.787523 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.unique_dim_patient_patient_key.b601210326
[0m01:21:42.792049 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.058 seconds
[0m01:21:42.794724 [debug] [Thread-2 (]: On test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b: ROLLBACK
[0m01:21:42.795896 [debug] [Thread-2 (]: On test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b: Close
[0m01:21:42.798497 [info ] [Thread-2 (]: 39 of 39 PASS unique_fact_admissions_admission_key ............................. [[32mPASS[0m in 0.16s]
[0m01:21:42.799898 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b
[0m01:21:42.801652 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:42.802163 [debug] [MainThread]: On master: BEGIN
[0m01:21:42.802614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:21:42.812088 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:21:42.812582 [debug] [MainThread]: On master: COMMIT
[0m01:21:42.813076 [debug] [MainThread]: Using postgres connection "master"
[0m01:21:42.813524 [debug] [MainThread]: On master: COMMIT
[0m01:21:42.814163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:21:42.814645 [debug] [MainThread]: On master: Close
[0m01:21:42.815275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:42.815913 [debug] [MainThread]: Connection 'test.healthcare_dw.unique_dim_patient_patient_key.b601210326' was properly closed.
[0m01:21:42.816542 [debug] [MainThread]: Connection 'test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b' was properly closed.
[0m01:21:42.817151 [debug] [MainThread]: Connection 'test.healthcare_dw.unique_dim_patient_patient_id.a04074ae61' was properly closed.
[0m01:21:42.817760 [debug] [MainThread]: Connection 'test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c' was properly closed.
[0m01:21:42.818303 [info ] [MainThread]: 
[0m01:21:42.818840 [info ] [MainThread]: Finished running 39 data tests in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m01:21:42.825169 [debug] [MainThread]: Command end result
[0m01:21:42.866772 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/manifest.json
[0m01:21:42.868872 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/semantic_manifest.json
[0m01:21:42.879132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/run_results.json
[0m01:21:42.879629 [info ] [MainThread]: 
[0m01:21:42.880249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:21:42.880800 [info ] [MainThread]: 
[0m01:21:42.881371 [info ] [MainThread]: Done. PASS=39 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=39
[0m01:21:42.882550 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.614916, "process_in_blocks": "8", "process_kernel_time": 0.402324, "process_mem_max_rss": "144760", "process_out_blocks": "3496", "process_user_time": 4.906172}
[0m01:21:42.883181 [debug] [MainThread]: Command `dbt test` succeeded at 01:21:42.883066 after 2.62 seconds
[0m01:21:42.883676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489b5680b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48983c0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489bf15310>]}
[0m01:21:42.884214 [debug] [MainThread]: Flushing usage events
[0m01:21:42.948147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:15.384333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde17802bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde19b23920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde17eb5100>]}


============================== 01:37:15.387629 | bb5bb1f8-74f6-4331-8736-6eb633de7ae3 ==============================
[0m01:37:15.387629 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:37:15.388431 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'log_path': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True'}
[0m01:37:15.572492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde16ca5790>]}
[0m01:37:15.643032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde16d3bec0>]}
[0m01:37:15.643893 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:37:15.773431 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:37:15.911347 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:37:15.912038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde17f25dc0>]}
[0m01:37:17.221292 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m01:37:17.222506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde1558bfe0>]}
[0m01:37:17.550722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde15567dd0>]}
[0m01:37:17.649822 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/manifest.json
[0m01:37:17.651809 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/semantic_manifest.json
[0m01:37:17.666482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde14977650>]}
[0m01:37:17.667081 [info ] [MainThread]: Found 15 models, 18 data tests, 7 sources, 459 macros
[0m01:37:17.667640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde179764b0>]}
[0m01:37:17.670110 [info ] [MainThread]: 
[0m01:37:17.670665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:37:17.671196 [info ] [MainThread]: 
[0m01:37:17.671893 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:37:17.678110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_healthcare'
[0m01:37:17.716937 [debug] [ThreadPool]: Using postgres connection "list_healthcare"
[0m01:37:17.717746 [debug] [ThreadPool]: On list_healthcare: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare"} */

    select distinct nspname from pg_namespace
  
[0m01:37:17.718467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:17.727870 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m01:37:17.729342 [debug] [ThreadPool]: On list_healthcare: Close
[0m01:37:17.732614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_healthcare, now list_healthcare_public)
[0m01:37:17.738667 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public"
[0m01:37:17.739159 [debug] [ThreadPool]: On list_healthcare_public: BEGIN
[0m01:37:17.739590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:17.746234 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:37:17.746701 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public"
[0m01:37:17.747224 [debug] [ThreadPool]: On list_healthcare_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare_public"} */
select
      'healthcare' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'healthcare' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'healthcare' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:37:17.750010 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m01:37:17.751373 [debug] [ThreadPool]: On list_healthcare_public: ROLLBACK
[0m01:37:17.752011 [debug] [ThreadPool]: On list_healthcare_public: Close
[0m01:37:17.760767 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:17.761268 [debug] [MainThread]: On master: BEGIN
[0m01:37:17.761700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:17.768334 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m01:37:17.768794 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:17.769349 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:37:17.772537 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m01:37:17.776218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde151f8740>]}
[0m01:37:17.776796 [debug] [MainThread]: On master: ROLLBACK
[0m01:37:17.777478 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:17.777927 [debug] [MainThread]: On master: BEGIN
[0m01:37:17.778788 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:37:17.779306 [debug] [MainThread]: On master: COMMIT
[0m01:37:17.779764 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:17.780223 [debug] [MainThread]: On master: COMMIT
[0m01:37:17.780860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:17.781358 [debug] [MainThread]: On master: Close
[0m01:37:17.784582 [debug] [Thread-1 (]: Began running node model.healthcare_dw.dim_date
[0m01:37:17.785139 [debug] [Thread-2 (]: Began running node model.healthcare_dw.stg_admissions
[0m01:37:17.785689 [debug] [Thread-3 (]: Began running node model.healthcare_dw.stg_doctors
[0m01:37:17.786743 [debug] [Thread-4 (]: Began running node model.healthcare_dw.stg_hospitals
[0m01:37:17.786304 [info ] [Thread-1 (]: 1 of 15 START sql view model public.dim_date ................................... [RUN]
[0m01:37:17.787591 [info ] [Thread-2 (]: 2 of 15 START sql view model public.stg_admissions ............................. [RUN]
[0m01:37:17.788189 [info ] [Thread-3 (]: 3 of 15 START sql view model public.stg_doctors ................................ [RUN]
[0m01:37:17.788990 [info ] [Thread-4 (]: 4 of 15 START sql view model public.stg_hospitals .............................. [RUN]
[0m01:37:17.789856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_healthcare_public, now model.healthcare_dw.dim_date)
[0m01:37:17.790537 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.healthcare_dw.stg_admissions'
[0m01:37:17.791175 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.healthcare_dw.stg_doctors'
[0m01:37:17.791847 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.healthcare_dw.stg_hospitals'
[0m01:37:17.792463 [debug] [Thread-1 (]: Began compiling node model.healthcare_dw.dim_date
[0m01:37:17.793110 [debug] [Thread-2 (]: Began compiling node model.healthcare_dw.stg_admissions
[0m01:37:17.794449 [debug] [Thread-3 (]: Began compiling node model.healthcare_dw.stg_doctors
[0m01:37:17.795296 [debug] [Thread-4 (]: Began compiling node model.healthcare_dw.stg_hospitals
[0m01:37:17.802780 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare_dw.dim_date"
[0m01:37:17.806638 [debug] [Thread-2 (]: Writing injected SQL for node "model.healthcare_dw.stg_admissions"
[0m01:37:17.809237 [debug] [Thread-3 (]: Writing injected SQL for node "model.healthcare_dw.stg_doctors"
[0m01:37:17.811826 [debug] [Thread-4 (]: Writing injected SQL for node "model.healthcare_dw.stg_hospitals"
[0m01:37:17.813167 [debug] [Thread-2 (]: Began executing node model.healthcare_dw.stg_admissions
[0m01:37:17.813827 [debug] [Thread-1 (]: Began executing node model.healthcare_dw.dim_date
[0m01:37:17.821325 [debug] [Thread-3 (]: Began executing node model.healthcare_dw.stg_doctors
[0m01:37:17.829266 [debug] [Thread-4 (]: Began executing node model.healthcare_dw.stg_hospitals
[0m01:37:17.896673 [debug] [Thread-3 (]: Writing runtime sql for node "model.healthcare_dw.stg_doctors"
[0m01:37:17.898772 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare_dw.dim_date"
[0m01:37:17.900855 [debug] [Thread-2 (]: Writing runtime sql for node "model.healthcare_dw.stg_admissions"
[0m01:37:17.902544 [debug] [Thread-4 (]: Writing runtime sql for node "model.healthcare_dw.stg_hospitals"
[0m01:37:17.903155 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:37:17.904068 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:37:17.904928 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: BEGIN
[0m01:37:17.905446 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:37:17.906083 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: BEGIN
[0m01:37:17.906572 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:37:17.907118 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:37:17.907663 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: BEGIN
[0m01:37:17.908217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:17.908747 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: BEGIN
[0m01:37:17.910987 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:37:17.909506 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:37:17.927619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:37:17.928606 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:37:17.929675 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m01:37:17.930925 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_date"} */

  create view "healthcare"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- Dimension: Date
WITH date_range AS (
    SELECT 
        generate_series(
            (SELECT MIN(date_of_admission) FROM "healthcare"."public"."admissions"),
            (SELECT MAX(discharge_date) FROM "healthcare"."public"."admissions"),
            '1 day'::interval
        )::date AS full_date
)

SELECT
    TO_CHAR(full_date, 'YYYYMMDD')::INTEGER AS date_key,
    full_date,
    TO_CHAR(full_date, 'Day') AS day_name,
    EXTRACT(MONTH FROM full_date)::INTEGER AS month,
    TO_CHAR(full_date, 'Month') AS month_name,
    EXTRACT(YEAR FROM full_date)::INTEGER AS year,
    CASE 
        WHEN EXTRACT(MONTH FROM full_date) IN (3, 4, 5) THEN 'Spring'
        WHEN EXTRACT(MONTH FROM full_date) IN (6, 7, 8) THEN 'Summer'
        WHEN EXTRACT(MONTH FROM full_date) IN (9, 10, 11) THEN 'Fall'
        ELSE 'Winter'
    END AS season
FROM date_range
  );
[0m01:37:17.931598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m01:37:17.932092 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:37:17.934202 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_doctors"} */

  create view "healthcare"."public"."stg_doctors__dbt_tmp"
    
    
  as (
    -- Staging: Doctors
SELECT
    doctor_id,
    name AS doctor_name
FROM "healthcare"."public"."doctors"
  );
[0m01:37:17.932552 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m01:37:17.935244 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:37:17.936008 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_admissions"} */

  create view "healthcare"."public"."stg_admissions__dbt_tmp"
    
    
  as (
    -- Staging: Admissions
SELECT
    admission_id,
    patient_id,
    doctor_id,
    hospital_id,
    insurance_id,
    condition_id,
    medication_id,
    date_of_admission,
    discharge_date,
    admission_type,
    billing_amount,
    room_number,
    test_results,
    (discharge_date - date_of_admission) AS length_of_stay
FROM "healthcare"."public"."admissions"
  );
[0m01:37:17.933366 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:37:17.938151 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_hospitals"} */

  create view "healthcare"."public"."stg_hospitals__dbt_tmp"
    
    
  as (
    -- Staging: Hospitals
SELECT
    hospital_id,
    name AS hospital_name
FROM "healthcare"."public"."hospitals"
  );
[0m01:37:17.940483 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m01:37:17.948596 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m01:37:17.953406 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:37:17.959790 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_date"} */
alter table "healthcare"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m01:37:17.958515 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:37:17.959026 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m01:37:17.954382 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m01:37:17.961127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:17.961716 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_doctors"} */
alter table "healthcare"."public"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m01:37:17.964782 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:37:17.968923 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:37:17.985152 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: COMMIT
[0m01:37:17.985934 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_hospitals"} */
alter table "healthcare"."public"."stg_hospitals__dbt_tmp" rename to "stg_hospitals"
[0m01:37:17.986640 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:17.987134 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_admissions"} */
alter table "healthcare"."public"."stg_admissions__dbt_tmp" rename to "stg_admissions"
[0m01:37:17.987693 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:37:17.989783 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: COMMIT
[0m01:37:17.990502 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:37:17.991194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:17.991653 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: COMMIT
[0m01:37:17.992222 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:37:17.993860 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: COMMIT
[0m01:37:17.995563 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: COMMIT
[0m01:37:17.996310 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: COMMIT
[0m01:37:17.997151 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:37:17.998103 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:37:17.999153 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: COMMIT
[0m01:37:18.000107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m01:37:18.000650 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m01:37:18.001128 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: COMMIT
[0m01:37:18.008072 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m01:37:18.008595 [debug] [Thread-1 (]: Applying DROP to: "healthcare"."public"."dim_date__dbt_backup"
[0m01:37:18.012321 [debug] [Thread-3 (]: Applying DROP to: "healthcare"."public"."stg_doctors__dbt_backup"
[0m01:37:18.016550 [debug] [Thread-4 (]: Applying DROP to: "healthcare"."public"."stg_hospitals__dbt_backup"
[0m01:37:18.017334 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m01:37:18.023328 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_date"
[0m01:37:18.024428 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_doctors"
[0m01:37:18.025509 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_hospitals"
[0m01:37:18.027933 [debug] [Thread-2 (]: Applying DROP to: "healthcare"."public"."stg_admissions__dbt_backup"
[0m01:37:18.028728 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_date"} */
drop view if exists "healthcare"."public"."dim_date__dbt_backup" cascade
[0m01:37:18.029322 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_doctors"} */
drop view if exists "healthcare"."public"."stg_doctors__dbt_backup" cascade
[0m01:37:18.029874 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_hospitals"} */
drop view if exists "healthcare"."public"."stg_hospitals__dbt_backup" cascade
[0m01:37:18.030989 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_admissions"
[0m01:37:18.032814 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_admissions"} */
drop view if exists "healthcare"."public"."stg_admissions__dbt_backup" cascade
[0m01:37:18.032132 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:37:18.033582 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:37:18.034651 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:37:18.035345 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m01:37:18.037805 [debug] [Thread-1 (]: On model.healthcare_dw.dim_date: Close
[0m01:37:18.039244 [debug] [Thread-3 (]: On model.healthcare_dw.stg_doctors: Close
[0m01:37:18.040622 [debug] [Thread-2 (]: On model.healthcare_dw.stg_admissions: Close
[0m01:37:18.042006 [debug] [Thread-4 (]: On model.healthcare_dw.stg_hospitals: Close
[0m01:37:18.046179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde19d49a00>]}
[0m01:37:18.046904 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde14428a40>]}
[0m01:37:18.047736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde1558b710>]}
[0m01:37:18.048761 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde1449fb30>]}
[0m01:37:18.050935 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.dim_date .............................. [[32mCREATE VIEW[0m in 0.25s]
[0m01:37:18.052071 [info ] [Thread-3 (]: 3 of 15 OK created sql view model public.stg_doctors ........................... [[32mCREATE VIEW[0m in 0.26s]
[0m01:37:18.052896 [info ] [Thread-2 (]: 2 of 15 OK created sql view model public.stg_admissions ........................ [[32mCREATE VIEW[0m in 0.26s]
[0m01:37:18.053733 [info ] [Thread-4 (]: 4 of 15 OK created sql view model public.stg_hospitals ......................... [[32mCREATE VIEW[0m in 0.26s]
[0m01:37:18.054591 [debug] [Thread-1 (]: Finished running node model.healthcare_dw.dim_date
[0m01:37:18.055309 [debug] [Thread-3 (]: Finished running node model.healthcare_dw.stg_doctors
[0m01:37:18.058599 [debug] [Thread-3 (]: Began running node model.healthcare_dw.stg_medical_conditions
[0m01:37:18.056860 [debug] [Thread-4 (]: Finished running node model.healthcare_dw.stg_hospitals
[0m01:37:18.057549 [debug] [Thread-1 (]: Began running node model.healthcare_dw.stg_insurance_providers
[0m01:37:18.056043 [debug] [Thread-2 (]: Finished running node model.healthcare_dw.stg_admissions
[0m01:37:18.059571 [info ] [Thread-3 (]: 6 of 15 START sql view model public.stg_medical_conditions ..................... [RUN]
[0m01:37:18.060844 [debug] [Thread-4 (]: Began running node model.healthcare_dw.stg_medications
[0m01:37:18.061613 [info ] [Thread-1 (]: 5 of 15 START sql view model public.stg_insurance_providers .................... [RUN]
[0m01:37:18.062326 [debug] [Thread-2 (]: Began running node model.healthcare_dw.stg_patients
[0m01:37:18.062947 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_doctors, now model.healthcare_dw.stg_medical_conditions)
[0m01:37:18.063651 [info ] [Thread-4 (]: 7 of 15 START sql view model public.stg_medications ............................ [RUN]
[0m01:37:18.064351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.dim_date, now model.healthcare_dw.stg_insurance_providers)
[0m01:37:18.067790 [debug] [Thread-1 (]: Began compiling node model.healthcare_dw.stg_insurance_providers
[0m01:37:18.065782 [debug] [Thread-3 (]: Began compiling node model.healthcare_dw.stg_medical_conditions
[0m01:37:18.066402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_hospitals, now model.healthcare_dw.stg_medications)
[0m01:37:18.065023 [info ] [Thread-2 (]: 8 of 15 START sql view model public.stg_patients ............................... [RUN]
[0m01:37:18.070795 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare_dw.stg_insurance_providers"
[0m01:37:18.074694 [debug] [Thread-3 (]: Writing injected SQL for node "model.healthcare_dw.stg_medical_conditions"
[0m01:37:18.075287 [debug] [Thread-4 (]: Began compiling node model.healthcare_dw.stg_medications
[0m01:37:18.075857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_admissions, now model.healthcare_dw.stg_patients)
[0m01:37:18.076838 [debug] [Thread-3 (]: Began executing node model.healthcare_dw.stg_medical_conditions
[0m01:37:18.077355 [debug] [Thread-1 (]: Began executing node model.healthcare_dw.stg_insurance_providers
[0m01:37:18.079885 [debug] [Thread-4 (]: Writing injected SQL for node "model.healthcare_dw.stg_medications"
[0m01:37:18.080497 [debug] [Thread-2 (]: Began compiling node model.healthcare_dw.stg_patients
[0m01:37:18.085775 [debug] [Thread-3 (]: Writing runtime sql for node "model.healthcare_dw.stg_medical_conditions"
[0m01:37:18.089607 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare_dw.stg_insurance_providers"
[0m01:37:18.092402 [debug] [Thread-2 (]: Writing injected SQL for node "model.healthcare_dw.stg_patients"
[0m01:37:18.092873 [debug] [Thread-4 (]: Began executing node model.healthcare_dw.stg_medications
[0m01:37:18.094035 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:37:18.101386 [debug] [Thread-1 (]: On model.healthcare_dw.stg_insurance_providers: BEGIN
[0m01:37:18.102190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:18.098931 [debug] [Thread-4 (]: Writing runtime sql for node "model.healthcare_dw.stg_medications"
[0m01:37:18.099526 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:37:18.100516 [debug] [Thread-2 (]: Began executing node model.healthcare_dw.stg_patients
[0m01:37:18.103580 [debug] [Thread-3 (]: On model.healthcare_dw.stg_medical_conditions: BEGIN
[0m01:37:18.104608 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:37:18.114361 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medications: BEGIN
[0m01:37:18.115079 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:18.112714 [debug] [Thread-2 (]: Writing runtime sql for node "model.healthcare_dw.stg_patients"
[0m01:37:18.116374 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:37:18.113595 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:37:18.117723 [debug] [Thread-2 (]: On model.healthcare_dw.stg_patients: BEGIN
[0m01:37:18.120099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:37:18.121829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:37:18.123844 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:37:18.125556 [debug] [Thread-1 (]: On model.healthcare_dw.stg_insurance_providers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_insurance_providers"} */

  create view "healthcare"."public"."stg_insurance_providers__dbt_tmp"
    
    
  as (
    -- Staging: Insurance Providers
SELECT
    insurance_id,
    name AS provider_name
FROM "healthcare"."public"."insuranceproviders"
  );
[0m01:37:18.128002 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:37:18.135344 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:37:18.136374 [debug] [Thread-1 (]: On model.healthcare_dw.stg_insurance_providers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_insurance_providers"} */
alter table "healthcare"."public"."stg_insurance_providers__dbt_tmp" rename to "stg_insurance_providers"
[0m01:37:18.137402 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m01:37:18.138126 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m01:37:18.139197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:18.140107 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:37:18.140987 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:37:18.141643 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m01:37:18.143391 [debug] [Thread-1 (]: On model.healthcare_dw.stg_insurance_providers: COMMIT
[0m01:37:18.143998 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medications"} */

  create view "healthcare"."public"."stg_medications__dbt_tmp"
    
    
  as (
    -- Staging: Medications
SELECT
    medication_id,
    medication_name
FROM "healthcare"."public"."medications"
  );
[0m01:37:18.144594 [debug] [Thread-3 (]: On model.healthcare_dw.stg_medical_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medical_conditions"} */

  create view "healthcare"."public"."stg_medical_conditions__dbt_tmp"
    
    
  as (
    -- Staging: Medical Conditions
SELECT
    condition_id,
    condition_name,
    CASE 
        WHEN LOWER(condition_name) IN ('diabetes', 'hypertension', 'arthritis', 'asthma') THEN TRUE
        ELSE FALSE
    END AS is_chronic
FROM "healthcare"."public"."medicalconditions"
  );
[0m01:37:18.145184 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:37:18.146781 [debug] [Thread-2 (]: On model.healthcare_dw.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_patients"} */

  create view "healthcare"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- Staging: Patients
SELECT
    patient_id,
    name AS patient_name,
    age,
    gender,
    blood_type,
    CASE 
        WHEN age BETWEEN 0 AND 18 THEN 'Pediatric'
        WHEN age BETWEEN 19 AND 40 THEN 'Young Adult'
        WHEN age BETWEEN 41 AND 60 THEN 'Middle Age'
        ELSE 'Senior'
    END AS age_group
FROM "healthcare"."public"."patients"
  );
[0m01:37:18.145743 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:37:18.147898 [debug] [Thread-1 (]: On model.healthcare_dw.stg_insurance_providers: COMMIT
[0m01:37:18.149560 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:18.150364 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:37:18.152822 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:18.153393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:37:18.157714 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:37:18.160702 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:37:18.163656 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:37:18.166130 [debug] [Thread-1 (]: Applying DROP to: "healthcare"."public"."stg_insurance_providers__dbt_backup"
[0m01:37:18.166708 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medications"} */
alter table "healthcare"."public"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m01:37:18.167310 [debug] [Thread-3 (]: On model.healthcare_dw.stg_medical_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medical_conditions"} */
alter table "healthcare"."public"."stg_medical_conditions__dbt_tmp" rename to "stg_medical_conditions"
[0m01:37:18.167868 [debug] [Thread-2 (]: On model.healthcare_dw.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_patients"} */
alter table "healthcare"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m01:37:18.169000 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.stg_insurance_providers"
[0m01:37:18.170018 [debug] [Thread-1 (]: On model.healthcare_dw.stg_insurance_providers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_insurance_providers"} */
drop view if exists "healthcare"."public"."stg_insurance_providers__dbt_backup" cascade
[0m01:37:18.170773 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:18.171271 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:18.171726 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:37:18.173601 [debug] [Thread-3 (]: On model.healthcare_dw.stg_medical_conditions: COMMIT
[0m01:37:18.174111 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:37:18.175751 [debug] [Thread-2 (]: On model.healthcare_dw.stg_patients: COMMIT
[0m01:37:18.178672 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medications: COMMIT
[0m01:37:18.179272 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:37:18.180671 [debug] [Thread-1 (]: On model.healthcare_dw.stg_insurance_providers: Close
[0m01:37:18.181248 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:37:18.183058 [debug] [Thread-2 (]: On model.healthcare_dw.stg_patients: COMMIT
[0m01:37:18.181802 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:37:18.183901 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medications: COMMIT
[0m01:37:18.184772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde14985460>]}
[0m01:37:18.182392 [debug] [Thread-3 (]: On model.healthcare_dw.stg_medical_conditions: COMMIT
[0m01:37:18.187026 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m01:37:18.186361 [info ] [Thread-1 (]: 5 of 15 OK created sql view model public.stg_insurance_providers ............... [[32mCREATE VIEW[0m in 0.12s]
[0m01:37:18.187913 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m01:37:18.188518 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m01:37:18.190886 [debug] [Thread-4 (]: Applying DROP to: "healthcare"."public"."stg_medications__dbt_backup"
[0m01:37:18.191649 [debug] [Thread-1 (]: Finished running node model.healthcare_dw.stg_insurance_providers
[0m01:37:18.194335 [debug] [Thread-2 (]: Applying DROP to: "healthcare"."public"."stg_patients__dbt_backup"
[0m01:37:18.197678 [debug] [Thread-3 (]: Applying DROP to: "healthcare"."public"."stg_medical_conditions__dbt_backup"
[0m01:37:18.198770 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.stg_medications"
[0m01:37:18.199397 [debug] [Thread-1 (]: Began running node model.healthcare_dw.dim_doctor
[0m01:37:18.200632 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.stg_patients"
[0m01:37:18.201692 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.stg_medical_conditions"
[0m01:37:18.202294 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medications"} */
drop view if exists "healthcare"."public"."stg_medications__dbt_backup" cascade
[0m01:37:18.202933 [info ] [Thread-1 (]: 9 of 15 START sql view model public.dim_doctor ................................. [RUN]
[0m01:37:18.203638 [debug] [Thread-2 (]: On model.healthcare_dw.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_patients"} */
drop view if exists "healthcare"."public"."stg_patients__dbt_backup" cascade
[0m01:37:18.204222 [debug] [Thread-3 (]: On model.healthcare_dw.stg_medical_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.stg_medical_conditions"} */
drop view if exists "healthcare"."public"."stg_medical_conditions__dbt_backup" cascade
[0m01:37:18.204922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_insurance_providers, now model.healthcare_dw.dim_doctor)
[0m01:37:18.205603 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:37:18.206488 [debug] [Thread-1 (]: Began compiling node model.healthcare_dw.dim_doctor
[0m01:37:18.207102 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:37:18.207574 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:37:18.209112 [debug] [Thread-4 (]: On model.healthcare_dw.stg_medications: Close
[0m01:37:18.212902 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare_dw.dim_doctor"
[0m01:37:18.214412 [debug] [Thread-2 (]: On model.healthcare_dw.stg_patients: Close
[0m01:37:18.215876 [debug] [Thread-3 (]: On model.healthcare_dw.stg_medical_conditions: Close
[0m01:37:18.216684 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde144d0710>]}
[0m01:37:18.218027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde1517bf50>]}
[0m01:37:18.220082 [debug] [Thread-1 (]: Began executing node model.healthcare_dw.dim_doctor
[0m01:37:18.221112 [info ] [Thread-4 (]: 7 of 15 OK created sql view model public.stg_medications ....................... [[32mCREATE VIEW[0m in 0.15s]
[0m01:37:18.229187 [debug] [Thread-4 (]: Finished running node model.healthcare_dw.stg_medications
[0m01:37:18.230048 [debug] [Thread-4 (]: Began running node model.healthcare_dw.dim_hospital
[0m01:37:18.222064 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde14480bf0>]}
[0m01:37:18.227897 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare_dw.dim_doctor"
[0m01:37:18.223032 [info ] [Thread-2 (]: 8 of 15 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m01:37:18.233830 [debug] [Thread-2 (]: Finished running node model.healthcare_dw.stg_patients
[0m01:37:18.231091 [info ] [Thread-4 (]: 10 of 15 START sql view model public.dim_hospital .............................. [RUN]
[0m01:37:18.232733 [info ] [Thread-3 (]: 6 of 15 OK created sql view model public.stg_medical_conditions ................ [[32mCREATE VIEW[0m in 0.16s]
[0m01:37:18.235084 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:37:18.238514 [debug] [Thread-1 (]: On model.healthcare_dw.dim_doctor: BEGIN
[0m01:37:18.239307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:18.236006 [debug] [Thread-2 (]: Began running node model.healthcare_dw.dim_insurance
[0m01:37:18.237689 [debug] [Thread-3 (]: Finished running node model.healthcare_dw.stg_medical_conditions
[0m01:37:18.241494 [debug] [Thread-3 (]: Began running node model.healthcare_dw.dim_medication
[0m01:37:18.236910 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_medications, now model.healthcare_dw.dim_hospital)
[0m01:37:18.244510 [debug] [Thread-4 (]: Began compiling node model.healthcare_dw.dim_hospital
[0m01:37:18.242405 [info ] [Thread-3 (]: 12 of 15 START sql view model public.dim_medication ............................ [RUN]
[0m01:37:18.240444 [info ] [Thread-2 (]: 11 of 15 START sql view model public.dim_insurance ............................. [RUN]
[0m01:37:18.253144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_patients, now model.healthcare_dw.dim_insurance)
[0m01:37:18.250685 [debug] [Thread-4 (]: Writing injected SQL for node "model.healthcare_dw.dim_hospital"
[0m01:37:18.254909 [debug] [Thread-4 (]: Began executing node model.healthcare_dw.dim_hospital
[0m01:37:18.251529 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.stg_medical_conditions, now model.healthcare_dw.dim_medication)
[0m01:37:18.253871 [debug] [Thread-2 (]: Began compiling node model.healthcare_dw.dim_insurance
[0m01:37:18.260722 [debug] [Thread-4 (]: Writing runtime sql for node "model.healthcare_dw.dim_hospital"
[0m01:37:18.268910 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:37:18.261798 [debug] [Thread-3 (]: Began compiling node model.healthcare_dw.dim_medication
[0m01:37:18.269696 [debug] [Thread-4 (]: On model.healthcare_dw.dim_hospital: BEGIN
[0m01:37:18.267789 [debug] [Thread-2 (]: Writing injected SQL for node "model.healthcare_dw.dim_insurance"
[0m01:37:18.273303 [debug] [Thread-3 (]: Writing injected SQL for node "model.healthcare_dw.dim_medication"
[0m01:37:18.273787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m01:37:18.274369 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:18.275368 [debug] [Thread-2 (]: Began executing node model.healthcare_dw.dim_insurance
[0m01:37:18.275833 [debug] [Thread-3 (]: Began executing node model.healthcare_dw.dim_medication
[0m01:37:18.276398 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:37:18.290087 [debug] [Thread-2 (]: Writing runtime sql for node "model.healthcare_dw.dim_insurance"
[0m01:37:18.290803 [debug] [Thread-1 (]: On model.healthcare_dw.dim_doctor: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_doctor"} */

  create view "healthcare"."public"."dim_doctor__dbt_tmp"
    
    
  as (
    -- Dimension: Doctor
SELECT
    ROW_NUMBER() OVER (ORDER BY doctor_id) AS doctor_key,
    doctor_id,
    doctor_name
FROM "healthcare"."public"."stg_doctors"
  );
[0m01:37:18.292849 [debug] [Thread-3 (]: Writing runtime sql for node "model.healthcare_dw.dim_medication"
[0m01:37:18.293364 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m01:37:18.294728 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:37:18.295603 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:37:18.296382 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:37:18.297029 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:18.297488 [debug] [Thread-3 (]: On model.healthcare_dw.dim_medication: BEGIN
[0m01:37:18.298046 [debug] [Thread-2 (]: On model.healthcare_dw.dim_insurance: BEGIN
[0m01:37:18.298618 [debug] [Thread-4 (]: On model.healthcare_dw.dim_hospital: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_hospital"} */

  create view "healthcare"."public"."dim_hospital__dbt_tmp"
    
    
  as (
    -- Dimension: Hospital
SELECT
    ROW_NUMBER() OVER (ORDER BY hospital_id) AS hospital_key,
    hospital_id,
    hospital_name
FROM "healthcare"."public"."stg_hospitals"
  );
[0m01:37:18.301590 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:37:18.303450 [debug] [Thread-1 (]: On model.healthcare_dw.dim_doctor: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_doctor"} */
alter table "healthcare"."public"."dim_doctor__dbt_tmp" rename to "dim_doctor"
[0m01:37:18.302184 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:37:18.302729 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:37:18.305893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:37:18.308808 [debug] [Thread-1 (]: On model.healthcare_dw.dim_doctor: COMMIT
[0m01:37:18.312237 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:37:18.312937 [debug] [Thread-1 (]: On model.healthcare_dw.dim_doctor: COMMIT
[0m01:37:18.309725 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:37:18.320007 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:37:18.320659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m01:37:18.321564 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m01:37:18.322296 [debug] [Thread-4 (]: On model.healthcare_dw.dim_hospital: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_hospital"} */
alter table "healthcare"."public"."dim_hospital__dbt_tmp" rename to "dim_hospital"
[0m01:37:18.325804 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:37:18.322769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m01:37:18.325199 [debug] [Thread-1 (]: Applying DROP to: "healthcare"."public"."dim_doctor__dbt_backup"
[0m01:37:18.327097 [debug] [Thread-3 (]: On model.healthcare_dw.dim_medication: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_medication"} */

  create view "healthcare"."public"."dim_medication__dbt_tmp"
    
    
  as (
    -- Dimension: Medication
SELECT
    ROW_NUMBER() OVER (ORDER BY medication_id) AS medication_key,
    medication_id,
    medication_name
FROM "healthcare"."public"."stg_medications"
  );
[0m01:37:18.328480 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:37:18.329058 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:37:18.331782 [debug] [Thread-2 (]: On model.healthcare_dw.dim_insurance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_insurance"} */

  create view "healthcare"."public"."dim_insurance__dbt_tmp"
    
    
  as (
    -- Dimension: Insurance
SELECT
    ROW_NUMBER() OVER (ORDER BY insurance_id) AS insurance_key,
    insurance_id,
    provider_name
FROM "healthcare"."public"."stg_insurance_providers"
  );
[0m01:37:18.330837 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_doctor"
[0m01:37:18.335316 [debug] [Thread-1 (]: On model.healthcare_dw.dim_doctor: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_doctor"} */
drop view if exists "healthcare"."public"."dim_doctor__dbt_backup" cascade
[0m01:37:18.334599 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:18.334095 [debug] [Thread-4 (]: On model.healthcare_dw.dim_hospital: COMMIT
[0m01:37:18.339141 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:37:18.339648 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m01:37:18.340181 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m01:37:18.340645 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:37:18.341218 [debug] [Thread-3 (]: On model.healthcare_dw.dim_medication: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_medication"} */
alter table "healthcare"."public"."dim_medication__dbt_tmp" rename to "dim_medication"
[0m01:37:18.342637 [debug] [Thread-1 (]: On model.healthcare_dw.dim_doctor: Close
[0m01:37:18.345586 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:37:18.346175 [debug] [Thread-4 (]: On model.healthcare_dw.dim_hospital: COMMIT
[0m01:37:18.347095 [debug] [Thread-2 (]: On model.healthcare_dw.dim_insurance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_insurance"} */
alter table "healthcare"."public"."dim_insurance__dbt_tmp" rename to "dim_insurance"
[0m01:37:18.348175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde14313b30>]}
[0m01:37:18.349282 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:37:18.350682 [info ] [Thread-1 (]: 9 of 15 OK created sql view model public.dim_doctor ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m01:37:18.351480 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m01:37:18.351948 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:37:18.353622 [debug] [Thread-3 (]: On model.healthcare_dw.dim_medication: COMMIT
[0m01:37:18.354394 [debug] [Thread-1 (]: Finished running node model.healthcare_dw.dim_doctor
[0m01:37:18.357036 [debug] [Thread-4 (]: Applying DROP to: "healthcare"."public"."dim_hospital__dbt_backup"
[0m01:37:18.359706 [debug] [Thread-2 (]: On model.healthcare_dw.dim_insurance: COMMIT
[0m01:37:18.360314 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:37:18.360897 [debug] [Thread-1 (]: Began running node model.healthcare_dw.dim_patient
[0m01:37:18.362040 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_hospital"
[0m01:37:18.362600 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:37:18.363166 [debug] [Thread-3 (]: On model.healthcare_dw.dim_medication: COMMIT
[0m01:37:18.363795 [info ] [Thread-1 (]: 13 of 15 START sql view model public.dim_patient ............................... [RUN]
[0m01:37:18.364491 [debug] [Thread-4 (]: On model.healthcare_dw.dim_hospital: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_hospital"} */
drop view if exists "healthcare"."public"."dim_hospital__dbt_backup" cascade
[0m01:37:18.365057 [debug] [Thread-2 (]: On model.healthcare_dw.dim_insurance: COMMIT
[0m01:37:18.365929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.dim_doctor, now model.healthcare_dw.dim_patient)
[0m01:37:18.366705 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m01:37:18.367600 [debug] [Thread-1 (]: Began compiling node model.healthcare_dw.dim_patient
[0m01:37:18.368350 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m01:37:18.368813 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:37:18.372574 [debug] [Thread-3 (]: Applying DROP to: "healthcare"."public"."dim_medication__dbt_backup"
[0m01:37:18.375725 [debug] [Thread-1 (]: Writing injected SQL for node "model.healthcare_dw.dim_patient"
[0m01:37:18.378265 [debug] [Thread-2 (]: Applying DROP to: "healthcare"."public"."dim_insurance__dbt_backup"
[0m01:37:18.379689 [debug] [Thread-4 (]: On model.healthcare_dw.dim_hospital: Close
[0m01:37:18.380791 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.dim_medication"
[0m01:37:18.383363 [debug] [Thread-3 (]: On model.healthcare_dw.dim_medication: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_medication"} */
drop view if exists "healthcare"."public"."dim_medication__dbt_backup" cascade
[0m01:37:18.382057 [debug] [Thread-2 (]: Using postgres connection "model.healthcare_dw.dim_insurance"
[0m01:37:18.384320 [debug] [Thread-2 (]: On model.healthcare_dw.dim_insurance: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_insurance"} */
drop view if exists "healthcare"."public"."dim_insurance__dbt_backup" cascade
[0m01:37:18.382695 [debug] [Thread-1 (]: Began executing node model.healthcare_dw.dim_patient
[0m01:37:18.385221 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde1432dc70>]}
[0m01:37:18.386175 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:37:18.386835 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:37:18.394439 [info ] [Thread-4 (]: 10 of 15 OK created sql view model public.dim_hospital ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m01:37:18.395194 [debug] [Thread-1 (]: Writing runtime sql for node "model.healthcare_dw.dim_patient"
[0m01:37:18.396513 [debug] [Thread-3 (]: On model.healthcare_dw.dim_medication: Close
[0m01:37:18.398198 [debug] [Thread-2 (]: On model.healthcare_dw.dim_insurance: Close
[0m01:37:18.398910 [debug] [Thread-4 (]: Finished running node model.healthcare_dw.dim_hospital
[0m01:37:18.399805 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:37:18.400643 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde1439d520>]}
[0m01:37:18.402916 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde143ac650>]}
[0m01:37:18.406135 [debug] [Thread-4 (]: Began running node model.healthcare_dw.dim_condition
[0m01:37:18.407168 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: BEGIN
[0m01:37:18.408284 [info ] [Thread-3 (]: 12 of 15 OK created sql view model public.dim_medication ....................... [[32mCREATE VIEW[0m in 0.15s]
[0m01:37:18.409257 [info ] [Thread-2 (]: 11 of 15 OK created sql view model public.dim_insurance ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m01:37:18.410126 [info ] [Thread-4 (]: 14 of 15 START sql view model public.dim_condition ............................. [RUN]
[0m01:37:18.410976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:18.411699 [debug] [Thread-3 (]: Finished running node model.healthcare_dw.dim_medication
[0m01:37:18.412426 [debug] [Thread-2 (]: Finished running node model.healthcare_dw.dim_insurance
[0m01:37:18.413005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.dim_hospital, now model.healthcare_dw.dim_condition)
[0m01:37:18.414544 [debug] [Thread-4 (]: Began compiling node model.healthcare_dw.dim_condition
[0m01:37:18.420030 [debug] [Thread-4 (]: Writing injected SQL for node "model.healthcare_dw.dim_condition"
[0m01:37:18.420942 [debug] [Thread-4 (]: Began executing node model.healthcare_dw.dim_condition
[0m01:37:18.426343 [debug] [Thread-4 (]: Writing runtime sql for node "model.healthcare_dw.dim_condition"
[0m01:37:18.427332 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:37:18.427975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:37:18.428556 [debug] [Thread-4 (]: On model.healthcare_dw.dim_condition: BEGIN
[0m01:37:18.429131 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:37:18.429680 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:18.430274 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_patient"} */

  create view "healthcare"."public"."dim_patient__dbt_tmp"
    
    
  as (
    -- Dimension: Patient
SELECT
    ROW_NUMBER() OVER (ORDER BY patient_id) AS patient_key,
    patient_id,
    patient_name,
    age,
    age_group,
    gender,
    blood_type
FROM "healthcare"."public"."stg_patients"
  );
[0m01:37:18.433020 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:37:18.437840 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:37:18.440193 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_patient"} */
alter table "healthcare"."public"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m01:37:18.441597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:18.444413 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: COMMIT
[0m01:37:18.444997 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m01:37:18.445473 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:37:18.446028 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:37:18.447448 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: COMMIT
[0m01:37:18.448276 [debug] [Thread-4 (]: On model.healthcare_dw.dim_condition: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_condition"} */

  create view "healthcare"."public"."dim_condition__dbt_tmp"
    
    
  as (
    -- Dimension: Medical Condition
SELECT
    ROW_NUMBER() OVER (ORDER BY condition_id) AS condition_key,
    condition_id,
    condition_name,
    is_chronic
FROM "healthcare"."public"."stg_medical_conditions"
  );
[0m01:37:18.450887 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:37:18.454579 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:37:18.455156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:37:18.455622 [debug] [Thread-4 (]: On model.healthcare_dw.dim_condition: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_condition"} */
alter table "healthcare"."public"."dim_condition__dbt_tmp" rename to "dim_condition"
[0m01:37:18.458120 [debug] [Thread-1 (]: Applying DROP to: "healthcare"."public"."dim_patient__dbt_backup"
[0m01:37:18.459508 [debug] [Thread-1 (]: Using postgres connection "model.healthcare_dw.dim_patient"
[0m01:37:18.460082 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:18.460550 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_patient"} */
drop view if exists "healthcare"."public"."dim_patient__dbt_backup" cascade
[0m01:37:18.462222 [debug] [Thread-4 (]: On model.healthcare_dw.dim_condition: COMMIT
[0m01:37:18.462928 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:37:18.463588 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:37:18.464072 [debug] [Thread-4 (]: On model.healthcare_dw.dim_condition: COMMIT
[0m01:37:18.465576 [debug] [Thread-1 (]: On model.healthcare_dw.dim_patient: Close
[0m01:37:18.466880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde143ace60>]}
[0m01:37:18.467868 [info ] [Thread-1 (]: 13 of 15 OK created sql view model public.dim_patient .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m01:37:18.469021 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m01:37:18.469653 [debug] [Thread-1 (]: Finished running node model.healthcare_dw.dim_patient
[0m01:37:18.472137 [debug] [Thread-4 (]: Applying DROP to: "healthcare"."public"."dim_condition__dbt_backup"
[0m01:37:18.473508 [debug] [Thread-4 (]: Using postgres connection "model.healthcare_dw.dim_condition"
[0m01:37:18.474110 [debug] [Thread-4 (]: On model.healthcare_dw.dim_condition: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.dim_condition"} */
drop view if exists "healthcare"."public"."dim_condition__dbt_backup" cascade
[0m01:37:18.475619 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:37:18.477371 [debug] [Thread-4 (]: On model.healthcare_dw.dim_condition: Close
[0m01:37:18.478101 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde14482c60>]}
[0m01:37:18.479103 [info ] [Thread-4 (]: 14 of 15 OK created sql view model public.dim_condition ........................ [[32mCREATE VIEW[0m in 0.07s]
[0m01:37:18.480203 [debug] [Thread-4 (]: Finished running node model.healthcare_dw.dim_condition
[0m01:37:18.481322 [debug] [Thread-3 (]: Began running node model.healthcare_dw.fact_admissions
[0m01:37:18.481945 [info ] [Thread-3 (]: 15 of 15 START sql view model public.fact_admissions ........................... [RUN]
[0m01:37:18.482610 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.healthcare_dw.dim_medication, now model.healthcare_dw.fact_admissions)
[0m01:37:18.483150 [debug] [Thread-3 (]: Began compiling node model.healthcare_dw.fact_admissions
[0m01:37:18.488600 [debug] [Thread-3 (]: Writing injected SQL for node "model.healthcare_dw.fact_admissions"
[0m01:37:18.489523 [debug] [Thread-3 (]: Began executing node model.healthcare_dw.fact_admissions
[0m01:37:18.494493 [debug] [Thread-3 (]: Writing runtime sql for node "model.healthcare_dw.fact_admissions"
[0m01:37:18.495333 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:37:18.496158 [debug] [Thread-3 (]: On model.healthcare_dw.fact_admissions: BEGIN
[0m01:37:18.496939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:37:18.506928 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m01:37:18.507791 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:37:18.508675 [debug] [Thread-3 (]: On model.healthcare_dw.fact_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.fact_admissions"} */

  create view "healthcare"."public"."fact_admissions__dbt_tmp"
    
    
  as (
    -- Fact Table: Admissions
-- Grain: One row per hospital admission

SELECT
    ROW_NUMBER() OVER (ORDER BY a.admission_id) AS admission_key,
    
    -- Foreign keys to dimensions
    p.patient_key,
    d.doctor_key,
    h.hospital_key,
    i.insurance_key,
    c.condition_key,
    m.medication_key,
    
    -- Degenerate dimensions (no separate table needed)
    a.admission_type,
    a.room_number,
    a.test_results,
    
    -- Measures
    a.billing_amount,
    a.length_of_stay,
    
    -- Dates for reference
    a.date_of_admission,
    a.discharge_date

FROM "healthcare"."public"."stg_admissions" a
LEFT JOIN "healthcare"."public"."dim_patient" p ON a.patient_id = p.patient_id
LEFT JOIN "healthcare"."public"."dim_doctor" d ON a.doctor_id = d.doctor_id
LEFT JOIN "healthcare"."public"."dim_hospital" h ON a.hospital_id = h.hospital_id
LEFT JOIN "healthcare"."public"."dim_insurance" i ON a.insurance_id = i.insurance_id
LEFT JOIN "healthcare"."public"."dim_condition" c ON a.condition_id = c.condition_id
LEFT JOIN "healthcare"."public"."dim_medication" m ON a.medication_id = m.medication_id
  );
[0m01:37:18.512104 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:37:18.515507 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:37:18.516373 [debug] [Thread-3 (]: On model.healthcare_dw.fact_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.fact_admissions"} */
alter table "healthcare"."public"."fact_admissions__dbt_tmp" rename to "fact_admissions"
[0m01:37:18.517489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:18.520277 [debug] [Thread-3 (]: On model.healthcare_dw.fact_admissions: COMMIT
[0m01:37:18.520918 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:37:18.521461 [debug] [Thread-3 (]: On model.healthcare_dw.fact_admissions: COMMIT
[0m01:37:18.523422 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m01:37:18.525859 [debug] [Thread-3 (]: Applying DROP to: "healthcare"."public"."fact_admissions__dbt_backup"
[0m01:37:18.526916 [debug] [Thread-3 (]: Using postgres connection "model.healthcare_dw.fact_admissions"
[0m01:37:18.527445 [debug] [Thread-3 (]: On model.healthcare_dw.fact_admissions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "model.healthcare_dw.fact_admissions"} */
drop view if exists "healthcare"."public"."fact_admissions__dbt_backup" cascade
[0m01:37:18.528216 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:37:18.531275 [debug] [Thread-3 (]: On model.healthcare_dw.fact_admissions: Close
[0m01:37:18.532111 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5bb1f8-74f6-4331-8736-6eb633de7ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde143e0290>]}
[0m01:37:18.533103 [info ] [Thread-3 (]: 15 of 15 OK created sql view model public.fact_admissions ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:37:18.534354 [debug] [Thread-3 (]: Finished running node model.healthcare_dw.fact_admissions
[0m01:37:18.536075 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:18.536566 [debug] [MainThread]: On master: BEGIN
[0m01:37:18.537058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:18.545069 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:37:18.545547 [debug] [MainThread]: On master: COMMIT
[0m01:37:18.546029 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:18.546473 [debug] [MainThread]: On master: COMMIT
[0m01:37:18.547096 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:18.547555 [debug] [MainThread]: On master: Close
[0m01:37:18.548162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:18.548775 [debug] [MainThread]: Connection 'model.healthcare_dw.dim_patient' was properly closed.
[0m01:37:18.549424 [debug] [MainThread]: Connection 'model.healthcare_dw.dim_insurance' was properly closed.
[0m01:37:18.550028 [debug] [MainThread]: Connection 'model.healthcare_dw.fact_admissions' was properly closed.
[0m01:37:18.550643 [debug] [MainThread]: Connection 'model.healthcare_dw.dim_condition' was properly closed.
[0m01:37:18.551212 [info ] [MainThread]: 
[0m01:37:18.551744 [info ] [MainThread]: Finished running 15 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m01:37:18.554485 [debug] [MainThread]: Command end result
[0m01:37:18.587023 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/manifest.json
[0m01:37:18.588787 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/semantic_manifest.json
[0m01:37:18.597191 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/run_results.json
[0m01:37:18.597683 [info ] [MainThread]: 
[0m01:37:18.598277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:18.598792 [info ] [MainThread]: 
[0m01:37:18.599405 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m01:37:18.600150 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:37:18.601284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.278151, "process_in_blocks": "912", "process_kernel_time": 0.415071, "process_mem_max_rss": "151032", "process_out_blocks": "3592", "process_user_time": 5.744304}
[0m01:37:18.601881 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:18.601768 after 3.28 seconds
[0m01:37:18.602404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde17f86c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde15d7e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dde1517b0b0>]}
[0m01:37:18.602906 [debug] [MainThread]: Flushing usage events
[0m01:37:18.683445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:28.563991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e4964a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e6105ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e41227b0>]}


============================== 01:37:28.567317 | 55215304-8d02-4f29-8259-136d3d7b58a5 ==============================
[0m01:37:28.567317 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:37:28.568129 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'partial_parse': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_path': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt test', 'introspect': 'True', 'write_json': 'True'}
[0m01:37:28.751909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55215304-8d02-4f29-8259-136d3d7b58a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e37e56d0>]}
[0m01:37:28.824996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55215304-8d02-4f29-8259-136d3d7b58a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e3a06540>]}
[0m01:37:28.826028 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:37:28.962033 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:37:29.098059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:37:29.098873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:37:29.164452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55215304-8d02-4f29-8259-136d3d7b58a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e23a1fd0>]}
[0m01:37:29.258444 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/manifest.json
[0m01:37:29.261011 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/semantic_manifest.json
[0m01:37:29.285584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55215304-8d02-4f29-8259-136d3d7b58a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e0f3e0c0>]}
[0m01:37:29.286173 [info ] [MainThread]: Found 15 models, 18 data tests, 7 sources, 459 macros
[0m01:37:29.286737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55215304-8d02-4f29-8259-136d3d7b58a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e23c6390>]}
[0m01:37:29.289574 [info ] [MainThread]: 
[0m01:37:29.290155 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:37:29.290663 [info ] [MainThread]: 
[0m01:37:29.291459 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:37:29.297122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_healthcare_public'
[0m01:37:29.338319 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public"
[0m01:37:29.338895 [debug] [ThreadPool]: On list_healthcare_public: BEGIN
[0m01:37:29.339386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:29.348122 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:37:29.348617 [debug] [ThreadPool]: Using postgres connection "list_healthcare_public"
[0m01:37:29.349138 [debug] [ThreadPool]: On list_healthcare_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "list_healthcare_public"} */
select
      'healthcare' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'healthcare' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'healthcare' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:37:29.352052 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.002 seconds
[0m01:37:29.353808 [debug] [ThreadPool]: On list_healthcare_public: ROLLBACK
[0m01:37:29.354527 [debug] [ThreadPool]: On list_healthcare_public: Close
[0m01:37:29.363773 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:29.364310 [debug] [MainThread]: On master: BEGIN
[0m01:37:29.364999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:29.373576 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:37:29.374084 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:29.374620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:37:29.377946 [debug] [MainThread]: SQL status: SELECT 28 in 0.003 seconds
[0m01:37:29.385396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55215304-8d02-4f29-8259-136d3d7b58a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e27ab1a0>]}
[0m01:37:29.385985 [debug] [MainThread]: On master: ROLLBACK
[0m01:37:29.386657 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:29.387247 [debug] [MainThread]: On master: BEGIN
[0m01:37:29.388311 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:37:29.388778 [debug] [MainThread]: On master: COMMIT
[0m01:37:29.389272 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:29.389714 [debug] [MainThread]: On master: COMMIT
[0m01:37:29.390378 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:29.390845 [debug] [MainThread]: On master: Close
[0m01:37:29.395259 [debug] [Thread-1 (]: Began running node test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686
[0m01:37:29.395782 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_dim_condition_condition_key.403465481c
[0m01:37:29.396381 [debug] [Thread-3 (]: Began running node test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6
[0m01:37:29.396886 [info ] [Thread-1 (]: 1 of 18 START test accepted_values_dim_date_season__Spring__Summer__Fall__Winter  [RUN]
[0m01:37:29.397554 [debug] [Thread-4 (]: Began running node test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f
[0m01:37:29.398134 [info ] [Thread-2 (]: 2 of 18 START test not_null_dim_condition_condition_key ........................ [RUN]
[0m01:37:29.398785 [info ] [Thread-3 (]: 3 of 18 START test not_null_dim_date_date_key .................................. [RUN]
[0m01:37:29.399509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_healthcare_public, now test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686)
[0m01:37:29.400106 [info ] [Thread-4 (]: 4 of 18 START test not_null_dim_doctor_doctor_key .............................. [RUN]
[0m01:37:29.400838 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.healthcare_dw.not_null_dim_condition_condition_key.403465481c'
[0m01:37:29.401496 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6'
[0m01:37:29.402078 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686
[0m01:37:29.402774 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f'
[0m01:37:29.403403 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_dim_condition_condition_key.403465481c
[0m01:37:29.404035 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6
[0m01:37:29.500185 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f
[0m01:37:29.503993 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"
[0m01:37:29.521223 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"
[0m01:37:29.522096 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"
[0m01:37:29.526264 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"
[0m01:37:29.527279 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_dim_condition_condition_key.403465481c
[0m01:37:29.528003 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686
[0m01:37:29.528733 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6
[0m01:37:29.551074 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"
[0m01:37:29.552552 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"
[0m01:37:29.553072 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f
[0m01:37:29.555615 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"
[0m01:37:29.556601 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"
[0m01:37:29.559296 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"
[0m01:37:29.559806 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"
[0m01:37:29.562455 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_condition_condition_key.403465481c: BEGIN
[0m01:37:29.564464 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:37:29.563684 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"
[0m01:37:29.560688 [debug] [Thread-1 (]: On test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686: BEGIN
[0m01:37:29.566538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:29.561251 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"
[0m01:37:29.565579 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f: BEGIN
[0m01:37:29.569181 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:37:29.567713 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6: BEGIN
[0m01:37:29.570887 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:37:29.585874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m01:37:29.586694 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"
[0m01:37:29.587917 [debug] [Thread-1 (]: On test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        season as value_field,
        count(*) as n_records

    from "healthcare"."public"."dim_date"
    group by season

)

select *
from all_values
where value_field not in (
    'Spring','Summer','Fall','Winter'
)



  
  
      
    ) dbt_internal_test
[0m01:37:29.588739 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m01:37:29.589893 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"
[0m01:37:29.591007 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_condition_condition_key.403465481c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_condition_condition_key.403465481c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select condition_key
from "healthcare"."public"."dim_condition"
where condition_key is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.591873 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m01:37:29.594004 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"
[0m01:37:29.594820 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "healthcare"."public"."dim_date"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.592924 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m01:37:29.595779 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"
[0m01:37:29.596640 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:37:29.597468 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select doctor_key
from "healthcare"."public"."dim_doctor"
where doctor_key is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.603682 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_condition_condition_key.403465481c: ROLLBACK
[0m01:37:29.606013 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_condition_condition_key.403465481c: Close
[0m01:37:29.608564 [info ] [Thread-2 (]: 2 of 18 PASS not_null_dim_condition_condition_key .............................. [[32mPASS[0m in 0.21s]
[0m01:37:29.609737 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_dim_condition_condition_key.403465481c
[0m01:37:29.610578 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703
[0m01:37:29.613536 [info ] [Thread-2 (]: 5 of 18 START test not_null_dim_hospital_hospital_key .......................... [RUN]
[0m01:37:29.615865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_condition_condition_key.403465481c, now test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703)
[0m01:37:29.616678 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703
[0m01:37:29.630790 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"
[0m01:37:29.631804 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703
[0m01:37:29.638642 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"
[0m01:37:29.639873 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"
[0m01:37:29.642368 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703: BEGIN
[0m01:37:29.643125 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.053 seconds
[0m01:37:29.643908 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:37:29.648038 [debug] [Thread-1 (]: On test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686: ROLLBACK
[0m01:37:29.648795 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.053 seconds
[0m01:37:29.649306 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.045 seconds
[0m01:37:29.652195 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6: ROLLBACK
[0m01:37:29.655112 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f: ROLLBACK
[0m01:37:29.655856 [debug] [Thread-1 (]: On test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686: Close
[0m01:37:29.657379 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6: Close
[0m01:37:29.658482 [info ] [Thread-3 (]: 3 of 18 PASS not_null_dim_date_date_key ........................................ [[32mPASS[0m in 0.26s]
[0m01:37:29.663802 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6
[0m01:37:29.661743 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f: Close
[0m01:37:29.660548 [info ] [Thread-1 (]: 1 of 18 PASS accepted_values_dim_date_season__Spring__Summer__Fall__Winter ..... [[32mPASS[0m in 0.26s]
[0m01:37:29.665753 [debug] [Thread-3 (]: Began running node test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5
[0m01:37:29.669040 [info ] [Thread-4 (]: 4 of 18 PASS not_null_dim_doctor_doctor_key .................................... [[32mPASS[0m in 0.27s]
[0m01:37:29.673159 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f
[0m01:37:29.671098 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686
[0m01:37:29.676222 [debug] [Thread-1 (]: Began running node test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d
[0m01:37:29.673893 [debug] [Thread-4 (]: Began running node test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9
[0m01:37:29.671931 [info ] [Thread-3 (]: 6 of 18 START test not_null_dim_insurance_insurance_key ........................ [RUN]
[0m01:37:29.678372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_date_date_key.881d0a31b6, now test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5)
[0m01:37:29.679222 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5
[0m01:37:29.675108 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m01:37:29.687395 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"
[0m01:37:29.676913 [info ] [Thread-1 (]: 8 of 18 START test not_null_dim_patient_patient_key ............................ [RUN]
[0m01:37:29.689287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.accepted_values_dim_date_season__Spring__Summer__Fall__Winter.4d30b41686, now test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d)
[0m01:37:29.677757 [info ] [Thread-4 (]: 7 of 18 START test not_null_dim_medication_medication_key ...................... [RUN]
[0m01:37:29.686472 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"
[0m01:37:29.692017 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5
[0m01:37:29.688534 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hospital_key
from "healthcare"."public"."dim_hospital"
where hospital_key is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.691053 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_doctor_doctor_key.78b87a9e1f, now test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9)
[0m01:37:29.690154 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d
[0m01:37:29.696069 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"
[0m01:37:29.707914 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"
[0m01:37:29.698247 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9
[0m01:37:29.708707 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5: BEGIN
[0m01:37:29.719072 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:37:29.718227 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"
[0m01:37:29.721620 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"
[0m01:37:29.725213 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d
[0m01:37:29.728150 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9
[0m01:37:29.747221 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"
[0m01:37:29.742537 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"
[0m01:37:29.752731 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"
[0m01:37:29.756616 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m01:37:29.760446 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9: BEGIN
[0m01:37:29.764090 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:29.762705 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"
[0m01:37:29.757689 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"
[0m01:37:29.763379 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.066 seconds
[0m01:37:29.765044 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select insurance_key
from "healthcare"."public"."dim_insurance"
where insurance_key is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.769655 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703: ROLLBACK
[0m01:37:29.773861 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703: Close
[0m01:37:29.766194 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d: BEGIN
[0m01:37:29.779706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:29.783548 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m01:37:29.787339 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5: ROLLBACK
[0m01:37:29.777643 [info ] [Thread-2 (]: 5 of 18 PASS not_null_dim_hospital_hospital_key ................................ [[32mPASS[0m in 0.16s]
[0m01:37:29.789272 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703
[0m01:37:29.793549 [debug] [Thread-2 (]: Began running node test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9
[0m01:37:29.792603 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5: Close
[0m01:37:29.794419 [info ] [Thread-2 (]: 9 of 18 START test not_null_fact_admissions_admission_key ...................... [RUN]
[0m01:37:29.796110 [info ] [Thread-3 (]: 6 of 18 PASS not_null_dim_insurance_insurance_key .............................. [[32mPASS[0m in 0.12s]
[0m01:37:29.798216 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m01:37:29.799223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_hospital_hospital_key.2355c53703, now test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9)
[0m01:37:29.802499 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9
[0m01:37:29.801620 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"
[0m01:37:29.800076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m01:37:29.800724 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5
[0m01:37:29.807385 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"
[0m01:37:29.808026 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select medication_key
from "healthcare"."public"."dim_medication"
where medication_key is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.808612 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"
[0m01:37:29.809249 [debug] [Thread-3 (]: Began running node test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402
[0m01:37:29.810185 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9
[0m01:37:29.811124 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_key
from "healthcare"."public"."dim_patient"
where patient_key is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.811893 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:37:29.812487 [info ] [Thread-3 (]: 10 of 18 START test not_null_fact_admissions_billing_amount .................... [RUN]
[0m01:37:29.820381 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_insurance_insurance_key.5c80398dd5, now test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402)
[0m01:37:29.819494 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9: ROLLBACK
[0m01:37:29.815871 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"
[0m01:37:29.821397 [debug] [Thread-3 (]: Began compiling node test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402
[0m01:37:29.822611 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"
[0m01:37:29.830402 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9: BEGIN
[0m01:37:29.823655 [debug] [Thread-4 (]: On test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9: Close
[0m01:37:29.831353 [debug] [Thread-3 (]: Writing injected SQL for node "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"
[0m01:37:29.832235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:37:29.833390 [info ] [Thread-4 (]: 7 of 18 PASS not_null_dim_medication_medication_key ............................ [[32mPASS[0m in 0.14s]
[0m01:37:29.835473 [debug] [Thread-3 (]: Began executing node test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402
[0m01:37:29.837389 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9
[0m01:37:29.848146 [debug] [Thread-4 (]: Began running node test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838
[0m01:37:29.847356 [debug] [Thread-3 (]: Writing runtime sql for node "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"
[0m01:37:29.849087 [info ] [Thread-4 (]: 11 of 18 START test unique_dim_condition_condition_key ......................... [RUN]
[0m01:37:29.851248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_medication_medication_key.23a9f2e6f9, now test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838)
[0m01:37:29.850352 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"
[0m01:37:29.852163 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838
[0m01:37:29.853111 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402: BEGIN
[0m01:37:29.860528 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:37:29.869844 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"
[0m01:37:29.871322 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m01:37:29.874467 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.058 seconds
[0m01:37:29.875646 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838
[0m01:37:29.878127 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"
[0m01:37:29.878912 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m01:37:29.880630 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d: ROLLBACK
[0m01:37:29.883623 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"
[0m01:37:29.884254 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select admission_key
from "healthcare"."public"."fact_admissions"
where admission_key is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.884845 [debug] [Thread-3 (]: Using postgres connection "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"
[0m01:37:29.886988 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select billing_amount
from "healthcare"."public"."fact_admissions"
where billing_amount is null



  
  
      
    ) dbt_internal_test
[0m01:37:29.886154 [debug] [Thread-1 (]: On test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d: Close
[0m01:37:29.888052 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"
[0m01:37:29.890328 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838: BEGIN
[0m01:37:29.891164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:29.889331 [info ] [Thread-1 (]: 8 of 18 PASS not_null_dim_patient_patient_key .................................. [[32mPASS[0m in 0.20s]
[0m01:37:29.893509 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d
[0m01:37:29.894389 [debug] [Thread-1 (]: Began running node test.healthcare_dw.unique_dim_date_date_key.0869fd48f9
[0m01:37:29.896293 [info ] [Thread-1 (]: 12 of 18 START test unique_dim_date_date_key ................................... [RUN]
[0m01:37:29.898831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_dim_patient_patient_key.95c900620d, now test.healthcare_dw.unique_dim_date_date_key.0869fd48f9)
[0m01:37:29.901292 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.unique_dim_date_date_key.0869fd48f9
[0m01:37:29.913802 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"
[0m01:37:29.914842 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.unique_dim_date_date_key.0869fd48f9
[0m01:37:29.918971 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"
[0m01:37:29.920040 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"
[0m01:37:29.920763 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_date_date_key.0869fd48f9: BEGIN
[0m01:37:29.921496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:29.927219 [debug] [Thread-4 (]: SQL status: BEGIN in 0.036 seconds
[0m01:37:29.929402 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"
[0m01:37:29.932176 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    condition_key as unique_field,
    count(*) as n_records

from "healthcare"."public"."dim_condition"
where condition_key is not null
group by condition_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:37:29.938202 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:37:29.944121 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838: ROLLBACK
[0m01:37:29.949405 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838: Close
[0m01:37:29.952436 [info ] [Thread-4 (]: 11 of 18 PASS unique_dim_condition_condition_key ............................... [[32mPASS[0m in 0.10s]
[0m01:37:29.954765 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838
[0m01:37:29.958287 [debug] [Thread-4 (]: Began running node test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9
[0m01:37:29.961550 [info ] [Thread-4 (]: 13 of 18 START test unique_dim_doctor_doctor_key ............................... [RUN]
[0m01:37:29.962605 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_condition_condition_key.725f9a7838, now test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9)
[0m01:37:29.965383 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9
[0m01:37:29.968264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m01:37:29.977286 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"
[0m01:37:29.982911 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_date_date_key.0869fd48f9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_date_date_key.0869fd48f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "healthcare"."public"."dim_date"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:37:29.982166 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"
[0m01:37:29.986806 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9
[0m01:37:29.994283 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"
[0m01:37:29.996560 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"
[0m01:37:29.999469 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9: BEGIN
[0m01:37:30.000343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:30.024358 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m01:37:30.027257 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"
[0m01:37:30.028122 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    doctor_key as unique_field,
    count(*) as n_records

from "healthcare"."public"."dim_doctor"
where doctor_key is not null
group by doctor_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:37:30.057794 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.072 seconds
[0m01:37:30.063470 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_date_date_key.0869fd48f9: ROLLBACK
[0m01:37:30.065250 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_date_date_key.0869fd48f9: Close
[0m01:37:30.067527 [info ] [Thread-1 (]: 12 of 18 PASS unique_dim_date_date_key ......................................... [[32mPASS[0m in 0.17s]
[0m01:37:30.070780 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.unique_dim_date_date_key.0869fd48f9
[0m01:37:30.071602 [debug] [Thread-1 (]: Began running node test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c
[0m01:37:30.073781 [info ] [Thread-1 (]: 14 of 18 START test unique_dim_hospital_hospital_key ........................... [RUN]
[0m01:37:30.077565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_date_date_key.0869fd48f9, now test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c)
[0m01:37:30.079559 [debug] [Thread-1 (]: Began compiling node test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c
[0m01:37:30.098393 [debug] [Thread-1 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"
[0m01:37:30.100508 [debug] [Thread-1 (]: Began executing node test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c
[0m01:37:30.106714 [debug] [Thread-1 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"
[0m01:37:30.110540 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"
[0m01:37:30.113268 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c: BEGIN
[0m01:37:30.114060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:30.137533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m01:37:30.139216 [debug] [Thread-1 (]: Using postgres connection "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"
[0m01:37:30.140017 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hospital_key as unique_field,
    count(*) as n_records

from "healthcare"."public"."dim_hospital"
where hospital_key is not null
group by hospital_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:37:30.147080 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.116 seconds
[0m01:37:30.149631 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9: ROLLBACK
[0m01:37:30.152347 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9: Close
[0m01:37:30.154313 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.268 seconds
[0m01:37:30.156736 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9: ROLLBACK
[0m01:37:30.153546 [info ] [Thread-4 (]: 13 of 18 PASS unique_dim_doctor_doctor_key ..................................... [[32mPASS[0m in 0.19s]
[0m01:37:30.158202 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9
[0m01:37:30.159547 [debug] [Thread-4 (]: Began running node test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59
[0m01:37:30.160739 [info ] [Thread-4 (]: 15 of 18 START test unique_dim_insurance_insurance_key ......................... [RUN]
[0m01:37:30.161887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_doctor_doctor_key.0f3a10fce9, now test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59)
[0m01:37:30.163604 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59
[0m01:37:30.162697 [debug] [Thread-2 (]: On test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9: Close
[0m01:37:30.170646 [info ] [Thread-2 (]: 9 of 18 PASS not_null_fact_admissions_admission_key ............................ [[32mPASS[0m in 0.37s]
[0m01:37:30.172171 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9
[0m01:37:30.174817 [debug] [Thread-2 (]: Began running node test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c
[0m01:37:30.174058 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"
[0m01:37:30.176656 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59
[0m01:37:30.175688 [info ] [Thread-2 (]: 16 of 18 START test unique_dim_medication_medication_key ....................... [RUN]
[0m01:37:30.183083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.not_null_fact_admissions_admission_key.2b3bd6ccf9, now test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c)
[0m01:37:30.181926 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"
[0m01:37:30.184027 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c
[0m01:37:30.191039 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"
[0m01:37:30.194972 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59: BEGIN
[0m01:37:30.195844 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:30.194211 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"
[0m01:37:30.197310 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c
[0m01:37:30.204359 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"
[0m01:37:30.207516 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"
[0m01:37:30.208336 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c: BEGIN
[0m01:37:30.211235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:37:30.217325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m01:37:30.218237 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"
[0m01:37:30.219219 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    insurance_key as unique_field,
    count(*) as n_records

from "healthcare"."public"."dim_insurance"
where insurance_key is not null
group by insurance_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:37:30.223942 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:37:30.226462 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59: ROLLBACK
[0m01:37:30.227510 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59: Close
[0m01:37:30.228617 [info ] [Thread-4 (]: 15 of 18 PASS unique_dim_insurance_insurance_key ............................... [[32mPASS[0m in 0.07s]
[0m01:37:30.231923 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59
[0m01:37:30.232970 [debug] [Thread-4 (]: Began running node test.healthcare_dw.unique_dim_patient_patient_key.b601210326
[0m01:37:30.234924 [info ] [Thread-4 (]: 17 of 18 START test unique_dim_patient_patient_key ............................. [RUN]
[0m01:37:30.236861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_insurance_insurance_key.0a2e009a59, now test.healthcare_dw.unique_dim_patient_patient_key.b601210326)
[0m01:37:30.238900 [debug] [Thread-4 (]: Began compiling node test.healthcare_dw.unique_dim_patient_patient_key.b601210326
[0m01:37:30.238075 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m01:37:30.244985 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"
[0m01:37:30.247746 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    medication_key as unique_field,
    count(*) as n_records

from "healthcare"."public"."dim_medication"
where medication_key is not null
group by medication_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:37:30.246858 [debug] [Thread-4 (]: Writing injected SQL for node "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"
[0m01:37:30.249031 [debug] [Thread-4 (]: Began executing node test.healthcare_dw.unique_dim_patient_patient_key.b601210326
[0m01:37:30.251323 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:37:30.255545 [debug] [Thread-4 (]: Writing runtime sql for node "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"
[0m01:37:30.259140 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"
[0m01:37:30.259874 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_patient_patient_key.b601210326: BEGIN
[0m01:37:30.257841 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c: ROLLBACK
[0m01:37:30.260669 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:37:30.263544 [debug] [Thread-2 (]: On test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c: Close
[0m01:37:30.264830 [info ] [Thread-2 (]: 16 of 18 PASS unique_dim_medication_medication_key ............................. [[32mPASS[0m in 0.08s]
[0m01:37:30.267510 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c
[0m01:37:30.268474 [debug] [Thread-2 (]: Began running node test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b
[0m01:37:30.270302 [info ] [Thread-2 (]: 18 of 18 START test unique_fact_admissions_admission_key ....................... [RUN]
[0m01:37:30.272020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.healthcare_dw.unique_dim_medication_medication_key.ca155b672c, now test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b)
[0m01:37:30.274080 [debug] [Thread-2 (]: Began compiling node test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b
[0m01:37:30.286431 [debug] [Thread-2 (]: Writing injected SQL for node "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"
[0m01:37:30.287292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.144 seconds
[0m01:37:30.289807 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c: ROLLBACK
[0m01:37:30.290984 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m01:37:30.292750 [debug] [Thread-4 (]: Using postgres connection "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"
[0m01:37:30.291809 [debug] [Thread-2 (]: Began executing node test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b
[0m01:37:30.293841 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_patient_patient_key.b601210326: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_dim_patient_patient_key.b601210326"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_key as unique_field,
    count(*) as n_records

from "healthcare"."public"."dim_patient"
where patient_key is not null
group by patient_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:37:30.298691 [debug] [Thread-1 (]: On test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c: Close
[0m01:37:30.298009 [debug] [Thread-2 (]: Writing runtime sql for node "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"
[0m01:37:30.302825 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"
[0m01:37:30.304179 [debug] [Thread-2 (]: On test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b: BEGIN
[0m01:37:30.301757 [info ] [Thread-1 (]: 14 of 18 PASS unique_dim_hospital_hospital_key ................................. [[32mPASS[0m in 0.22s]
[0m01:37:30.305046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:37:30.308486 [debug] [Thread-1 (]: Finished running node test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c
[0m01:37:30.316498 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.429 seconds
[0m01:37:30.322284 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402: ROLLBACK
[0m01:37:30.323946 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m01:37:30.325570 [debug] [Thread-2 (]: Using postgres connection "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"
[0m01:37:30.324770 [debug] [Thread-3 (]: On test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402: Close
[0m01:37:30.326519 [debug] [Thread-2 (]: On test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "healthcare_dw", "target_name": "dev", "node_id": "test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    admission_key as unique_field,
    count(*) as n_records

from "healthcare"."public"."fact_admissions"
where admission_key is not null
group by admission_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:37:30.327642 [info ] [Thread-3 (]: 10 of 18 PASS not_null_fact_admissions_billing_amount .......................... [[32mPASS[0m in 0.51s]
[0m01:37:30.329404 [debug] [Thread-3 (]: Finished running node test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402
[0m01:37:30.385177 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.086 seconds
[0m01:37:30.387875 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_patient_patient_key.b601210326: ROLLBACK
[0m01:37:30.389019 [debug] [Thread-4 (]: On test.healthcare_dw.unique_dim_patient_patient_key.b601210326: Close
[0m01:37:30.390191 [info ] [Thread-4 (]: 17 of 18 PASS unique_dim_patient_patient_key ................................... [[32mPASS[0m in 0.15s]
[0m01:37:30.393908 [debug] [Thread-4 (]: Finished running node test.healthcare_dw.unique_dim_patient_patient_key.b601210326
[0m01:37:30.478921 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.150 seconds
[0m01:37:30.481675 [debug] [Thread-2 (]: On test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b: ROLLBACK
[0m01:37:30.482496 [debug] [Thread-2 (]: On test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b: Close
[0m01:37:30.483703 [info ] [Thread-2 (]: 18 of 18 PASS unique_fact_admissions_admission_key ............................. [[32mPASS[0m in 0.21s]
[0m01:37:30.486999 [debug] [Thread-2 (]: Finished running node test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b
[0m01:37:30.489267 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:30.489907 [debug] [MainThread]: On master: BEGIN
[0m01:37:30.490653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:30.499134 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:37:30.499645 [debug] [MainThread]: On master: COMMIT
[0m01:37:30.500151 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:30.500592 [debug] [MainThread]: On master: COMMIT
[0m01:37:30.501242 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:30.501712 [debug] [MainThread]: On master: Close
[0m01:37:30.502340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:30.502992 [debug] [MainThread]: Connection 'test.healthcare_dw.unique_dim_hospital_hospital_key.29e8a4c67c' was properly closed.
[0m01:37:30.503615 [debug] [MainThread]: Connection 'test.healthcare_dw.unique_fact_admissions_admission_key.4dfbb69c0b' was properly closed.
[0m01:37:30.504233 [debug] [MainThread]: Connection 'test.healthcare_dw.not_null_fact_admissions_billing_amount.b66b80c402' was properly closed.
[0m01:37:30.504865 [debug] [MainThread]: Connection 'test.healthcare_dw.unique_dim_patient_patient_key.b601210326' was properly closed.
[0m01:37:30.505399 [info ] [MainThread]: 
[0m01:37:30.505946 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m01:37:30.509163 [debug] [MainThread]: Command end result
[0m01:37:30.540259 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/manifest.json
[0m01:37:30.542220 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/semantic_manifest.json
[0m01:37:30.551662 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/EAS550_DMQL_Project_anjaneya_sfaham/dbt_healthcare/target/run_results.json
[0m01:37:30.552161 [info ] [MainThread]: 
[0m01:37:30.552754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:30.553314 [info ] [MainThread]: 
[0m01:37:30.553878 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m01:37:30.555047 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.051455, "process_in_blocks": "1472", "process_kernel_time": 0.354878, "process_mem_max_rss": "143248", "process_out_blocks": "2624", "process_user_time": 4.220768}
[0m01:37:30.555656 [debug] [MainThread]: Command `dbt test` succeeded at 01:37:30.555544 after 2.05 seconds
[0m01:37:30.556178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e4558e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e45f70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4e0f94410>]}
[0m01:37:30.556691 [debug] [MainThread]: Flushing usage events
[0m01:37:30.596327 [debug] [MainThread]: An error was encountered while trying to flush usage events
